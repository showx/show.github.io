---
layout: post
title: 求助：php-fpm 占用CPU过高，100%啦【已解决】
date: 2015-05-25 13:30
author: admin
comments: true
categories: []
---
话说最近配置的LNMP还算稳定，正在暗自窃喜，但是从昨晚开始，就发现服务器的CPU占用过高，甚至到了100%。我的内存是1G的，正常情况下占用率应该在5%以下，最多不超10%。

阿里云最近的监控显示：

cmhello.com-201303089

使用top命令查看，发现 php-fpm 占用内存过高，非常不正常：

cmhello.com-201303090

我按照《Nginx使用的php-fpm的两种进程管理方式及优化》这篇文章，配置 php-fpm 进程数如下：

cmhello.com-201303091

重启 php-fpm 后，还是没有彻底解决问题，依旧会出现占用 99以上，不知道哪位朋友知道如何分析和解决呢？小弟求助了！

后续进展

昨天（3月29日）找 @容哥 指导检查，后来发现是 eAccelerator 组件不知什么原因占用 CPU 过高，打开 php.ini

1
vi /usr/local/php/etc/php.ini
删除 eAccelerator  的配置信息，重启 lnmp

1
/root/lnmp restart
但还是没有彻底解决问题，几个小时后，我又重启了 lnmp ，居然发现，似乎已经越来越平稳啦。

可能用到的命令：

1
2
3
top                //查看CPU、内存使用信息，查看哪个进程占用CPU高以及它的PID
 
ll /proc/PID号/fd/             // 通过PID找到哪个文件操作的进程，进而知道问题所在
