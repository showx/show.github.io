---
layout: post
title: Linux的fuser命令解析
date: 2015-01-31 14:22
author: admin
comments: true
categories: []
---
fuser命令是用来显示所有正在使用着指定的file, file system 或者 sockets的进程信息。

例一：
<table border="0" width="400" cellspacing="0" cellpadding="2">
<tbody>
<tr>
<td valign="top" width="400">#fuser –m –u /mnt/usb1
/mnt/usb1: 1347c(root) 1348c(guido) 1349c(guido)</td>
</tr>
</tbody>
</table>
在例子一中，使用了-m和-u选项，用来查找所有正在使用/mnt/usb1的所有进程的PID已经该进程的OWNER，如1347c(root)，其中1347是进程PID，root是该进程的OWNER。

fuser会显示正在使用指定的file,file system 或者 sockets的进程的PID。在默认的显示模式下，每个文件名之后会跟随一个字符，用来指示当前的访问类型。

如下所示：

ccurrent directory.eexecutable being run.fopen file.Fopen file for writing.rroot directory.mmmap'ed file or shared library

同时fuser 可以用来查找哪些进程正在使用指定的network port。
<table border="0" width="400" cellspacing="0" cellpadding="2">
<tbody>
<tr>
<td valign="top" width="400">[root@bl25p-19 /]# fuser -v -n tcp 111

USER PID ACCESS COMMAND
111/tcp: rpc 2848 F.... portmap</td>
</tr>
</tbody>
</table>
<h3><a name="t0"></a></h3>
<h3><a name="t1"></a>fuser 的返回值：</h3>
fuser如果没有找到任何进程正在使用指定的file, filesystem 或 socket, 或者在查找过程中发生了fatal error，则返回non-zero 值。

fuser如果找到至少一个进程正在使用指定的file, filesystem 或 socket，则返回zero。
<h3><a name="t2"></a></h3>
<h3><a name="t3"></a>fuser 常用场景</h3>
fuser通常被用在诊断系统的“resource busy”问题，通常是在你希望umount指定的挂载点得时候遇到。 如果你希望kill所有正在使用某一指定的file, file system or sockets的进程的时候，你可以使用-k option。

fuser –k <tt>/path/to/your/filename</tt>

这时fuser会向所以正在使用/path/to/your/filename的进程发送SIGKILL。如果你希望在发送之前得到提示，可以使用-i 选项。

fuser –k –i <tt>/path/to/your/filename</tt>
<h3><a name="t4"></a><tt>fuser的其他有用的参数</tt></h3>
<dl><dt>-k</dt><dd>kills all process accessing a file. For example <tt>fuser -k /path/to/your/filename</tt> kills all processes accessing this directory without confirmation. Use -i for confirmation</dd><dt>-i</dt><dd>interactive mode. Prompt before killing process</dd><dt>-v</dt><dd>verbose.</dd><dt>-u</dt><dd>append username</dd><dt>-a</dt><dd>display all files</dd><dt>-m</dt><dd><tt>name</tt> specifies a file on a mounted file system or a block device that is mounted. All processes accessing files on that file system are listed. If a directory file is specified, it is automatically changed to<tt>name</tt>/. to use any file system that might be mounted on that directory.</dd></dl>&nbsp;
