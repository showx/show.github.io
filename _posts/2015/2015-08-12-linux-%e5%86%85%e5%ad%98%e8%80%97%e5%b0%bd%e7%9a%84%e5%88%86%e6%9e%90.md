---
layout: post
title: linux 内存耗尽的分析
date: 2015-08-12 17:31
author: admin
comments: true
categories: []
---
在测试NAS性能，用fstest长时间写，分析性能变差的原因，发现server主机内存使用率很高。

1．首先查看内存
<div>
<div id="highlighter_19313" class="syntaxhighlighter  shell">
<div class="toolbar"><a class="toolbar_item command_help help" href="http://my.oschina.net/hanhanztj/blog/490308#">?</a></div>
<table border="0" cellspacing="0" cellpadding="0">
<tbody>
<tr>
<td class="gutter">
<div class="line number1 index0 alt2">1</div>
<div class="line number2 index1 alt1">2</div>
<div class="line number3 index2 alt2">3</div>
<div class="line number4 index3 alt1">4</div>
<div class="line number5 index4 alt2">5</div>
<div class="line number6 index5 alt1">6</div>
<div class="line number7 index6 alt2">7</div>
<div class="line number8 index7 alt1">8</div>
<div class="line number9 index8 alt2">9</div>
<div class="line number10 index9 alt1">10</div>
<div class="line number11 index10 alt2">11</div>
<div class="line number12 index11 alt1">12</div>
<div class="line number13 index12 alt2">13</div>
<div class="line number14 index13 alt1">14</div></td>
<td class="code">
<div class="container">
<div class="line number1 index0 alt2"><code class="shell comments"># top -M </code></div>
<div class="line number2 index1 alt1"><code class="shell spaces"> </code><code class="shell functions">top</code> <code class="shell plain">- 14:43:12 up 14 days, 6 min,  1 user,  load average: 8.36, 8.38, 8.41</code></div>
<div class="line number3 index2 alt2"><code class="shell spaces"> </code><code class="shell plain">Tasks: 419 total,   1 running, 418 sleeping,   0 stopped,   0 zombie</code></div>
<div class="line number4 index3 alt1"><code class="shell spaces"> </code><code class="shell plain">Cpu(s):  0.0%us,  0.2%sy,  0.0%ni, 99.0%</code><code class="shell functions">id</code><code class="shell plain">,  0.7%wa,  0.0%hi,  0.0%si,  0.0%st</code></div>
<div class="line number5 index4 alt2"><code class="shell spaces"> </code></div>
<div class="line number6 index5 alt1"><code class="shell plain">Mem:    63.050G total,   62.639G used,  420.973M </code><code class="shell functions">free</code><code class="shell plain">,   33.973M buffers</code></div>
<div class="line number7 index6 alt2"><code class="shell spaces"> </code><code class="shell plain">Swap: 4095.996M total,    0.000k used, 4095.996M </code><code class="shell functions">free</code><code class="shell plain">,   48.889G cached</code></div>
<div class="line number8 index7 alt1"><code class="shell spaces">   </code><code class="shell plain">PID USER      PR  NI  VIRT  RES  SHR S %CPU %MEM    TIME+  COMMAND                                                                                                                         </code></div>
<div class="line number9 index8 alt2"><code class="shell spaces">   </code><code class="shell plain">111 root      20   0     0    0    0 S  2.0  0.0   0:25.52 ksoftirqd</code><code class="shell plain">/11</code></div>
<div class="line number10 index9 alt1"><code class="shell spaces">  </code><code class="shell plain">5968 root      20   0 15352 1372  828 R  2.0  0.0   0:00.01 </code><code class="shell functions">top</code></div>
<div class="line number11 index10 alt2"><code class="shell spaces"> </code><code class="shell plain">13273 root      20   0     0    0    0 D  2.0  0.0  25:54.02 nfsd                                                                                                                            </code></div>
<div class="line number12 index11 alt1"><code class="shell spaces"> </code><code class="shell plain">17765 root       0 -20     0    0    0 S  2.0  0.0   0:11.89 kworker</code><code class="shell plain">/5</code><code class="shell plain">:1H                                                                                                                    </code></div>
<div class="line number13 index12 alt2"><code class="shell spaces">     </code><code class="shell plain">1 root      20   0 19416 1436 1136 S  0.0  0.0   0:01.88 init </code></div>
<div class="line number14 index13 alt1"><code class="shell spaces"> </code><code class="shell plain">.....</code></div>
</div></td>
</tr>
</tbody>
</table>
</div>
</div>
发现内存基本用完，究竟是什么进程占用？top命令发现排名第一的%MEM才零点几。

2.通过 vmstat -m命令查看内核空间的内存使用。
<div>
<div id="highlighter_129489" class="syntaxhighlighter  shell">
<div class="toolbar"><a class="toolbar_item command_help help" href="http://my.oschina.net/hanhanztj/blog/490308#">?</a></div>
<table border="0" cellspacing="0" cellpadding="0">
<tbody>
<tr>
<td class="gutter">
<div class="line number1 index0 alt2">1</div>
<div class="line number2 index1 alt1">2</div>
<div class="line number3 index2 alt2">3</div>
<div class="line number4 index3 alt1">4</div>
<div class="line number5 index4 alt2">5</div>
<div class="line number6 index5 alt1">6</div>
<div class="line number7 index6 alt2">7</div>
<div class="line number8 index7 alt1">8</div>
<div class="line number9 index8 alt2">9</div>
<div class="line number10 index9 alt1">10</div>
<div class="line number11 index10 alt2">11</div>
<div class="line number12 index11 alt1">12</div>
<div class="line number13 index12 alt2">13</div>
<div class="line number14 index13 alt1">14</div>
<div class="line number15 index14 alt2">15</div>
<div class="line number16 index15 alt1">16</div>
<div class="line number17 index16 alt2">17</div>
<div class="line number18 index17 alt1">18</div>
<div class="line number19 index18 alt2">19</div>
<div class="line number20 index19 alt1">20</div>
<div class="line number21 index20 alt2">21</div>
<div class="line number22 index21 alt1">22</div>
<div class="line number23 index22 alt2">23</div>
<div class="line number24 index23 alt1">24</div>
<div class="line number25 index24 alt2">25</div>
<div class="line number26 index25 alt1">26</div>
<div class="line number27 index26 alt2">27</div>
<div class="line number28 index27 alt1">28</div>
<div class="line number29 index28 alt2">29</div>
<div class="line number30 index29 alt1">30</div>
<div class="line number31 index30 alt2">31</div>
<div class="line number32 index31 alt1">32</div>
<div class="line number33 index32 alt2">33</div>
<div class="line number34 index33 alt1">34</div>
<div class="line number35 index34 alt2">35</div>
<div class="line number36 index35 alt1">36</div>
<div class="line number37 index36 alt2">37</div>
<div class="line number38 index37 alt1">38</div>
<div class="line number39 index38 alt2">39</div>
<div class="line number40 index39 alt1">40</div>
<div class="line number41 index40 alt2">41</div>
<div class="line number42 index41 alt1">42</div>
<div class="line number43 index42 alt2">43</div>
<div class="line number44 index43 alt1">44</div>
<div class="line number45 index44 alt2">45</div>
<div class="line number46 index45 alt1">46</div>
<div class="line number47 index46 alt2">47</div>
<div class="line number48 index47 alt1">48</div>
<div class="line number49 index48 alt2">49</div>
<div class="line number50 index49 alt1">50</div>
<div class="line number51 index50 alt2">51</div></td>
<td class="code">
<div class="container">
<div class="line number1 index0 alt2"><code class="shell comments"># vmstat -m</code></div>
<div class="line number2 index1 alt1"><code class="shell spaces"> </code><code class="shell plain">Cache                       Num  Total   Size  Pages</code></div>
<div class="line number3 index2 alt2"><code class="shell spaces"> </code><code class="shell plain">xfs_dqtrx                     0      0    384     10</code></div>
<div class="line number4 index3 alt1"><code class="shell spaces"> </code><code class="shell plain">xfs_dquot                     0      0    504      7</code></div>
<div class="line number5 index4 alt2"><code class="shell spaces"> </code><code class="shell plain">xfs_buf                   91425 213300    384     10</code></div>
<div class="line number6 index5 alt1"><code class="shell spaces"> </code><code class="shell plain">fstrm_item                    0      0     24    144</code></div>
<div class="line number7 index6 alt2"><code class="shell spaces"> </code><code class="shell plain">xfs_mru_cache_elem            0      0     32    112</code></div>
<div class="line number8 index7 alt1"><code class="shell spaces"> </code></div>
<div class="line number9 index8 alt2"><code class="shell plain">xfs_ili                  7564110 8351947    224     17</code></div>
<div class="line number10 index9 alt1"><code class="shell spaces"> </code><code class="shell plain">xfs_inode                7564205 8484180   1024      4</code></div>
<div class="line number11 index10 alt2"><code class="shell spaces"> </code><code class="shell plain">xfs_efi_item                257    390    400     10</code></div>
<div class="line number12 index11 alt1"><code class="shell spaces"> </code><code class="shell plain">xfs_efd_item                237    380    400     10</code></div>
<div class="line number13 index12 alt2"><code class="shell spaces"> </code><code class="shell plain">xfs_buf_item               1795   2414    232     17</code></div>
<div class="line number14 index13 alt1"><code class="shell spaces"> </code><code class="shell plain">xfs_log_item_desc           830   1456     32    112</code></div>
<div class="line number15 index14 alt2"><code class="shell spaces"> </code><code class="shell plain">xfs_trans                   377    490    280     14</code></div>
<div class="line number16 index15 alt1"><code class="shell spaces"> </code><code class="shell plain">xfs_ifork                     0      0     64     59</code></div>
<div class="line number17 index16 alt2"><code class="shell spaces"> </code><code class="shell plain">xfs_da_state                  0      0    488      8</code></div>
<div class="line number18 index17 alt1"><code class="shell spaces"> </code><code class="shell plain">xfs_btree_cur               342    437    208     19</code></div>
<div class="line number19 index18 alt2"><code class="shell spaces"> </code><code class="shell plain">xfs_bmap_free_item           89    288     24    144</code></div>
<div class="line number20 index19 alt1"><code class="shell spaces"> </code><code class="shell plain">xfs_log_ticket              717    966    184     21</code></div>
<div class="line number21 index20 alt2"><code class="shell spaces"> </code><code class="shell plain">xfs_ioend                   726    896    120     32</code></div>
<div class="line number22 index21 alt1"><code class="shell spaces"> </code><code class="shell plain">rbd_segment_name            109    148    104     37</code></div>
<div class="line number23 index22 alt2"><code class="shell spaces"> </code><code class="shell plain">rbd_obj_request            1054   1452    176     22</code></div>
<div class="line number24 index23 alt1"><code class="shell spaces"> </code><code class="shell plain">rbd_img_request            1037   1472    120     32</code></div>
<div class="line number25 index24 alt2"><code class="shell spaces"> </code><code class="shell plain">ceph_osd_request            548    693    872      9</code></div>
<div class="line number26 index25 alt1"><code class="shell spaces"> </code><code class="shell plain">ceph_msg_data              1041   1540     48     77</code></div>
<div class="line number27 index26 alt2"><code class="shell spaces"> </code><code class="shell plain">ceph_msg                   1197   1632    232     17</code></div>
<div class="line number28 index27 alt1"><code class="shell spaces"> </code><code class="shell plain">nfsd_drc                  19323  33456    112     34</code></div>
<div class="line number29 index28 alt2"><code class="shell spaces"> </code><code class="shell plain">nfsd4_delegations             0      0    368     10</code></div>
<div class="line number30 index29 alt1"><code class="shell spaces"> </code><code class="shell plain">nfsd4_stateids              855   1024    120     32</code></div>
<div class="line number31 index30 alt2"><code class="shell spaces"> </code><code class="shell plain">nfsd4_files                 802   1050    128     30</code></div>
<div class="line number32 index31 alt1"><code class="shell spaces"> </code><code class="shell plain">nfsd4_lockowners              0      0    384     10</code></div>
<div class="line number33 index32 alt2"><code class="shell spaces"> </code><code class="shell plain">nfsd4_openowners             15     50    392     10</code></div>
<div class="line number34 index33 alt1"><code class="shell spaces"> </code><code class="shell plain">rpc_inode_cache              27     30    640      6</code></div>
<div class="line number35 index34 alt2"><code class="shell spaces"> </code><code class="shell plain">rpc_buffers                   8      8   2048      2</code></div>
<div class="line number36 index35 alt1"><code class="shell spaces"> </code><code class="shell plain">rpc_tasks                     8     15    256     15</code></div>
<div class="line number37 index36 alt2"><code class="shell spaces"> </code><code class="shell plain">fib6_nodes                   22     59     64     59</code></div>
<div class="line number38 index37 alt1"><code class="shell spaces"> </code><code class="shell plain">pte_list_desc                 0      0     32    112</code></div>
<div class="line number39 index38 alt2"><code class="shell spaces"> </code><code class="shell plain">ext4_groupinfo_4k           722    756    136     28</code></div>
<div class="line number40 index39 alt1"><code class="shell spaces"> </code><code class="shell plain">ext4_inode_cache           3362   3728    968      4</code></div>
<div class="line number41 index40 alt2"><code class="shell spaces"> </code><code class="shell plain">ext4_xattr                    0      0     88     44</code></div>
<div class="line number42 index41 alt1"><code class="shell spaces"> </code><code class="shell plain">ext4_free_data                0      0     64     59</code></div>
<div class="line number43 index42 alt2"><code class="shell spaces"> </code><code class="shell plain">ext4_allocation_context       0      0    136     28</code></div>
<div class="line number44 index43 alt1"><code class="shell spaces"> </code><code class="shell plain">ext4_prealloc_space          42     74    104     37</code></div>
<div class="line number45 index44 alt2"><code class="shell spaces"> </code><code class="shell plain">ext4_system_zone              0      0     40     92</code></div>
<div class="line number46 index45 alt1"><code class="shell spaces"> </code><code class="shell plain">Cache                       Num  Total   Size  Pages</code></div>
<div class="line number47 index46 alt2"><code class="shell spaces"> </code><code class="shell plain">ext4_io_end                   0      0     64     59</code></div>
<div class="line number48 index47 alt1"><code class="shell spaces"> </code><code class="shell plain">ext4_extent_status         1615   5704     40     92</code></div>
<div class="line number49 index48 alt2"><code class="shell spaces"> </code><code class="shell plain">jbd2_transaction_s           30     30    256     15</code></div>
<div class="line number50 index49 alt1"><code class="shell spaces"> </code><code class="shell plain">jbd2_inode                  254    539     48     77</code></div>
<div class="line number51 index50 alt2"><code class="shell spaces"> </code><code class="shell plain">........</code></div>
</div></td>
</tr>
</tbody>
</table>
</div>
</div>
发现这两项值很高： xfs_ili    xfs_inode  占用了大量的内存。

3.使用slabtop命令查看内核slab 缓冲区信息
<div>
<div id="highlighter_639419" class="syntaxhighlighter  shell">
<div class="toolbar"><a class="toolbar_item command_help help" href="http://my.oschina.net/hanhanztj/blog/490308#">?</a></div>
<table border="0" cellspacing="0" cellpadding="0">
<tbody>
<tr>
<td class="gutter">
<div class="line number1 index0 alt2">1</div>
<div class="line number2 index1 alt1">2</div>
<div class="line number3 index2 alt2">3</div>
<div class="line number4 index3 alt1">4</div>
<div class="line number5 index4 alt2">5</div>
<div class="line number6 index5 alt1">6</div>
<div class="line number7 index6 alt2">7</div>
<div class="line number8 index7 alt1">8</div>
<div class="line number9 index8 alt2">9</div>
<div class="line number10 index9 alt1">10</div>
<div class="line number11 index10 alt2">11</div>
<div class="line number12 index11 alt1">12</div>
<div class="line number13 index12 alt2">13</div></td>
<td class="code">
<div class="container">
<div class="line number1 index0 alt2"><code class="shell comments">#slabtop -s c | head</code></div>
<div class="line number2 index1 alt1"><code class="shell spaces">   </code><code class="shell plain">Active / Total Objects (% used)    : 31807723 / 35664583 (89.2%)</code></div>
<div class="line number3 index2 alt2"><code class="shell spaces">  </code><code class="shell plain">Active / Total Slabs (% used)      : 3259180 / 3259251 (100.0%)</code></div>
<div class="line number4 index3 alt1"><code class="shell spaces">  </code><code class="shell plain">Active / Total Caches (% used)     : 139 / 227 (61.2%)</code></div>
<div class="line number5 index4 alt2"><code class="shell spaces">  </code><code class="shell plain">Active / Total Size (% used)       : 11242773.43K / 12756788.05K (88.1%)</code></div>
<div class="line number6 index5 alt1"><code class="shell spaces">  </code><code class="shell plain">Minimum / Average / Maximum Object : 0.02K / 0.36K / 4096.00K</code></div>
<div class="line number7 index6 alt2"><code class="shell spaces">   </code><code class="shell plain">OBJS ACTIVE  USE OBJ SIZE  SLABS OBJ</code><code class="shell plain">/SLAB</code> <code class="shell plain">CACHE SIZE NAME                   </code></div>
<div class="line number8 index7 alt1"><code class="shell spaces"> </code><code class="shell plain">8480676 7565420  89%    1.00K 2120169        4   </code></div>
<div class="line number9 index8 alt2"><code class="shell plain">8480676K </code></div>
<div class="line number10 index9 alt1"><code class="shell plain">xfs_inode</code></div>
<div class="line number11 index10 alt2"><code class="shell spaces"> </code><code class="shell plain">8351794 7565375  90%    0.22K 491282       17   </code></div>
<div class="line number12 index11 alt1"><code class="shell plain">1965128K </code></div>
<div class="line number13 index12 alt2"><code class="shell plain">xfs_ili</code></div>
</div></td>
</tr>
</tbody>
</table>
</div>
</div>
&nbsp;

&nbsp;

xfs_ili 占用1965128k  xfs_inode占用8480676K，但他们究竟是什么东东？猜测是nas/rbd 卷的文件系统缓存信息。xfs_inode看字面意思是xfs文件系统的inode信息。

搜了下xfs_ili，只搜到内核代码片段。

&nbsp;
<div>
<div id="highlighter_495101" class="syntaxhighlighter  shell">
<div class="toolbar"><a class="toolbar_item command_help help" href="http://my.oschina.net/hanhanztj/blog/490308#">?</a></div>
<table border="0" cellspacing="0" cellpadding="0">
<tbody>
<tr>
<td class="gutter">
<div class="line number1 index0 alt2">1</div>
<div class="line number2 index1 alt1">2</div>
<div class="line number3 index2 alt2">3</div>
<div class="line number4 index3 alt1">4</div>
<div class="line number5 index4 alt2">5</div>
<div class="line number6 index5 alt1">6</div>
<div class="line number7 index6 alt2">7</div>
<div class="line number8 index7 alt1">8</div>
<div class="line number9 index8 alt2">9</div>
<div class="line number10 index9 alt1">10</div>
<div class="line number11 index10 alt2">11</div>
<div class="line number12 index11 alt1">12</div>
<div class="line number13 index12 alt2">13</div>
<div class="line number14 index13 alt1">14</div>
<div class="line number15 index14 alt2">15</div>
<div class="line number16 index15 alt1">16</div>
<div class="line number17 index16 alt2">17</div>
<div class="line number18 index17 alt1">18</div>
<div class="line number19 index18 alt2">19</div>
<div class="line number20 index19 alt1">20</div>
<div class="line number21 index20 alt2">21</div>
<div class="line number22 index21 alt1">22</div>
<div class="line number23 index22 alt2">23</div>
<div class="line number24 index23 alt1">24</div>
<div class="line number25 index24 alt2">25</div>
<div class="line number26 index25 alt1">26</div>
<div class="line number27 index26 alt2">27</div></td>
<td class="code">
<div class="container">
<div class="line number1 index0 alt2"><code class="shell spaces"> </code><code class="shell plain">xfs_inode_zone =</code></div>
<div class="line number2 index1 alt1"><code class="shell plain">1636                 kmem_zone_init_flags(sizeof(xfs_inode_t), </code><code class="shell string">"xfs_inode"</code><code class="shell plain">,</code></div>
<div class="line number3 index2 alt2"><code class="shell plain">1637                         KM_ZONE_HWALIGN | KM_ZONE_RECLAIM | KM_ZONE_SPREAD,</code></div>
<div class="line number4 index3 alt1"><code class="shell plain">1638                         xfs_fs_inode_init_once);</code></div>
<div class="line number5 index4 alt2"><code class="shell plain">1639         </code><code class="shell keyword">if</code> <code class="shell plain">(!xfs_inode_zone)</code></div>
<div class="line number6 index5 alt1"><code class="shell plain">1640                 goto out_destroy_efi_zone;</code></div>
<div class="line number7 index6 alt2"><code class="shell plain">1641 </code></div>
<div class="line number8 index7 alt1"><code class="shell plain">1642         xfs_ili_zone =</code></div>
<div class="line number9 index8 alt2"><code class="shell plain">1643                 kmem_zone_init_flags(sizeof(xfs_inode_log_item_t), </code><code class="shell string">"xfs_ili"</code><code class="shell plain">,</code></div>
<div class="line number10 index9 alt1"><code class="shell plain">1644                                         KM_ZONE_SPREAD, NULL);</code></div>
<div class="line number11 index10 alt2"></div>
<div class="line number12 index11 alt1"></div>
<div class="line number13 index12 alt2"><code class="shell spaces"> </code><code class="shell plain">28 typedef struct xfs_inode_log_item {</code></div>
<div class="line number14 index13 alt1"><code class="shell spaces"> </code><code class="shell plain">29         xfs_log_item_t          ili_item;          /* common portion */</code></div>
<div class="line number15 index14 alt2"><code class="shell spaces"> </code><code class="shell plain">30         struct xfs_inode        *ili_inode;        /* inode ptr */</code></div>
<div class="line number16 index15 alt1"><code class="shell spaces"> </code><code class="shell plain">31         xfs_lsn_t               ili_flush_lsn;     /* lsn at last flush */</code></div>
<div class="line number17 index16 alt2"><code class="shell spaces"> </code><code class="shell plain">32         xfs_lsn_t               ili_last_lsn;      /* lsn at last transaction */</code></div>
<div class="line number18 index17 alt1"><code class="shell spaces"> </code><code class="shell plain">33         unsigned short          ili_lock_flags;    /* lock flags */</code></div>
<div class="line number19 index18 alt2"><code class="shell spaces"> </code><code class="shell plain">34         unsigned short          ili_logged;        /* flushed logged data */</code></div>
<div class="line number20 index19 alt1"><code class="shell spaces"> </code><code class="shell plain">35         unsigned int            ili_last_fields;   /* fields when flushed */</code></div>
<div class="line number21 index20 alt2"><code class="shell spaces"> </code><code class="shell plain">36         unsigned int            ili_fields;        /* fields to be logged */</code></div>
<div class="line number22 index21 alt1"><code class="shell spaces"> </code><code class="shell plain">37         struct xfs_bmbt_rec     *ili_extents_buf;  /* array of logged</code></div>
<div class="line number23 index22 alt2"><code class="shell spaces"> </code><code class="shell plain">38                                                       data exts */</code></div>
<div class="line number24 index23 alt1"><code class="shell spaces"> </code><code class="shell plain">39         struct xfs_bmbt_rec     *ili_aextents_buf; /* array of logged</code></div>
<div class="line number25 index24 alt2"><code class="shell spaces"> </code><code class="shell plain">40                                                       attr exts */</code></div>
<div class="line number26 index25 alt1"><code class="shell spaces"> </code><code class="shell plain">41         xfs_inode_log_format_t  ili_format;        /* logged structure */</code></div>
<div class="line number27 index26 alt2"><code class="shell spaces"> </code><code class="shell plain">42 } xfs_inode_log_item_t;</code></div>
</div></td>
</tr>
</tbody>
</table>
</div>
</div>
分析加估计是文件系统的日志缓存。究竟是不是？目前nfs-server有14个卷，每个卷的在格式化xfs的时指定的参数(即日志大小)-l=128m    14*128*1024 约等于1965128。

4.但是xfs_ili xfs_inode两者加起来才10G，还有50G去哪儿了呢？查资料说linux将用过的文件缓存到内存中。

执行下面的命令就释放了内存
<div>
<div id="highlighter_588566" class="syntaxhighlighter  shell">
<div class="toolbar"><a class="toolbar_item command_help help" href="http://my.oschina.net/hanhanztj/blog/490308#">?</a></div>
<table border="0" cellspacing="0" cellpadding="0">
<tbody>
<tr>
<td class="gutter">
<div class="line number1 index0 alt2">1</div>
<div class="line number2 index1 alt1">2</div>
<div class="line number3 index2 alt2">3</div></td>
<td class="code">
<div class="container">
<div class="line number1 index0 alt2"><code class="shell comments">#sync      #</code></div>
<div class="line number2 index1 alt1"><code class="shell plain">刷到磁盘</code></div>
<div class="line number3 index2 alt2"><code class="shell spaces"> </code><code class="shell comments">#echo 3 &gt; /proc/sys/vm/drop_caches</code></div>
</div></td>
</tr>
</tbody>
</table>
</div>
</div>
5.总结：是不是由于内存少导致的性能变差，还在测试。不过以后在优化nfs-server端有一定的指导意义。卷越多，必然占用的内存越多。做机头的内存配置要高。

&nbsp;
