---
layout: post
title: MongoDB的$inc修改器
date: 2015-04-08 11:36
author: admin
comments: true
categories: []
---
MongoDB的$inc修改器相当于编程语言中的 “+=”
“$inc”只能用于操作数值类型的数据，包括整数、长整数和双精度浮点数，用于其他类型的数据会导致操作失败。
<div>

<span class="pun">&gt;</span><span class="pln">db</span><span class="pun">.</span><span class="pln">users</span><span class="pun">.</span><span class="pln">findOne</span><span class="pun">()</span>
<span class="pun">{</span>
<span class="pun">“</span><span class="pln">_id</span><span class="pun">”</span> <span class="pun">:</span> <span class="typ">ObjectId</span><span class="pun">(“</span><span class="lit">4e91165aca685bef6dd86d3d</span><span class="pun">”),</span>
<span class="pun">“</span><span class="pln">relationships</span><span class="pun">”</span> <span class="pun">:</span> <span class="pun">{</span>
<span class="pun">“</span><span class="pln">friends</span><span class="pun">”</span> <span class="pun">:</span> <span class="lit">32</span><span class="pun">,</span>
<span class="pun">“</span><span class="pln">enemies</span><span class="pun">”</span> <span class="pun">:</span> <span class="lit">2</span>
<span class="pun">},</span>
<span class="pun">“</span><span class="pln">sex</span><span class="pun">”</span> <span class="pun">:</span> <span class="pun">“</span><span class="pln">mail</span><span class="pun">”,</span>
<span class="pun">“</span><span class="pln">username</span><span class="pun">”</span> <span class="pun">:</span> <span class="pun">“</span><span class="pln">joe</span><span class="pun">”</span>
<span class="pun">}</span>
<span class="pun">&gt;</span><span class="pln">db</span><span class="pun">.</span><span class="pln">users</span><span class="pun">.</span><span class="pln">update</span><span class="pun">({“</span><span class="pln">_id</span><span class="pun">”:</span><span class="typ">ObjectId</span><span class="pun">(“</span><span class="lit">4e91165aca685bef6dd86d3d</span><span class="pun">”)},{“</span><span class="pln">$inc</span><span class="pun">”:{“</span><span class="pln">relationships</span><span class="pun">.</span><span class="pln">friends</span><span class="pun">”:</span><span class="lit">20</span><span class="pun">}})</span>
<span class="pun">&gt;</span><span class="pln">db</span><span class="pun">.</span><span class="pln">users</span><span class="pun">.</span><span class="pln">findOne</span><span class="pun">()</span>
<span class="pun">{</span>
<span class="pun">“</span><span class="pln">_id</span><span class="pun">”</span> <span class="pun">:</span> <span class="typ">ObjectId</span><span class="pun">(“</span><span class="lit">4e91165aca685bef6dd86d3d</span><span class="pun">”),</span>
<span class="pun">“</span><span class="pln">relationships</span><span class="pun">”</span> <span class="pun">:</span> <span class="pun">{</span>
<span class="pun">“</span><span class="pln">friends</span><span class="pun">”</span> <span class="pun">:</span> <span class="lit">52</span><span class="pun">,</span>
<span class="pun">“</span><span class="pln">enemies</span><span class="pun">”</span> <span class="pun">:</span> <span class="lit">2</span>
<span class="pun">},</span>
<span class="pun">“</span><span class="pln">sex</span><span class="pun">”</span> <span class="pun">:</span> <span class="pun">“</span><span class="pln">mail</span><span class="pun">”,</span>
<span class="pun">“</span><span class="pln">username</span><span class="pun">”</span> <span class="pun">:</span> <span class="pun">“</span><span class="pln">joe</span><span class="pun">”</span>
<span class="pun">}</span>

我们使用”$inc”修改器将joe的朋友数量加20</div>
<div>

<span class="pun">&gt;</span><span class="pln">db</span><span class="pun">.</span><span class="pln">users</span><span class="pun">.</span><span class="pln">update</span><span class="pun">({“</span><span class="pln">_id</span><span class="pun">”:</span><span class="typ">Objec</span><span class="typ">tId</span><span class="pun">(“</span><span class="lit">4e91165aca685bef6dd86d3d</span><wbr /><span class="pun">”)},{“</span><span class="pln">$inc</span><span class="pun">”:{“</span><span class="pln">sex</span><span class="pun">”:</span><span class="lit">1</span><span class="pun">}})</span>
<em><span class="typ">Cannot</span><span class="pln"> apply $inc modifier to non</span><span class="pun">-</span><span class="pln">number</span></em>

我们想要使用$inc修改器操作sex，会提示$inc修改器不能应用于非数字数据</div>
