---
layout: post
title: php htmlentities汉字中文乱码问题解决办法
date: 2015-07-09 11:25
author: admin
comments: true
categories: []
---
htmlentities函数作用在汉字变量中的时候会出现乱码
<table border="0" width="620" cellspacing="1" cellpadding="1" align="center">
<tbody>
<tr>
<td bgcolor="#FFE7CE" width="464" height="27"> 代码如下</td>
<td align="center" bgcolor="#FFE7CE" width="109"></td>
</tr>
<tr>
<td id="copy1426" class="copyclass" colspan="2" valign="top" bgcolor="#FFFFFF" height="auto">$resultsText = str_replace("[QUERY]", htmlentities($query), $resultsText);</td>
</tr>
</tbody>
</table>
正确的做法是改变htmlentities的默认参数

<span style="color: #ff0000;">htmlentities($query,ENT_COMPAT,'UTF-8')</span>
<table border="0" width="620" cellspacing="1" cellpadding="1" align="center">
<tbody>
<tr>
<td bgcolor="#FFE7CE" width="464" height="27"> 代码如下</td>
<td align="center" bgcolor="#FFE7CE" width="109"></td>
</tr>
<tr>
<td id="copy2631" class="copyclass" colspan="2" valign="top" bgcolor="#FFFFFF" height="auto">&lt;?php
$query='你好';
$resultsText='1 条与 "[QUERY]" 相关的搜索结果';
$resultsText = str_replace("[QUERY]", htmlentities($query,ENT_COMPAT,'UTF-8'), $resultsText);
header('content-type: text/html; charset=utf-8');

print_r($resultsText);
?&gt;</td>
</tr>
</tbody>
</table>
