---
layout: post
title: Js处理Json的”invalid label”错
date: 2015-08-24 08:47
author: admin
comments: true
categories: []
---
当你使用ajax的时候,json是一个很方便的数据传输手段.
但是对于很多人来说,经常会遇到的一个很令人头疼的问题就是”invalid label”错. 明明json串看起来是对的,怎么还会出错呢?
比如,如下的代码:
<ol>
	<li>   function handle_success(response){</li>
	<li>       var json = eval(response); // response = "{'foo' : 'bar'}";</li>
	<li>  }</li>
</ol>
浏览器会报,invalid label错, 这是因为, eval会尝试将你的response解释为一个label, 当你在脚本中直接写:
<ol>
	<li>&lt;script&gt;</li>
	<li>  {'foo' : 'bar'};</li>
	<li>&lt;/script&gt;</li>
</ol>
会报错的原理是一样的.
解决办法有俩个:
<ol>
	<li>         var json = eval('(' + response + ')'); // response = "{'foo' : 'bar'}";</li>
	<li></li>
</ol>
或者
<ol>
	<li>       eval('var json = ' + response); // response = "{'foo' : 'bar'}";</li>
	<li>       //json is available now</li>
	<li></li>
</ol>
