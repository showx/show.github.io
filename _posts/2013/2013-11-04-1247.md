---
layout: post
title: firefox iframe scrollheight高度
date: 2013-11-04 15:41
author: admin
comments: true
categories: []
---
iframe在火狐下读取不了iframeJS的高度hashH = document.documentElement.scrollHeight;。
复杂一点，用以下代码解决

(function(){
var Browser=(function(){
var na = window.navigator,
ua = na.userAgent.toLowerCase(),
browserTester = /(msie|webkit|gecko|presto|opera|safari|firefox|chrome|maxthon|android|ipad|iphone|webos|hpwos)[ \/os]*([\d_.]+)/ig,
Browser = {
platform: na.platform
};
ua.replace(browserTester, function(a, b, c) {
var bLower = b.toLowerCase();
if (!Browser[bLower]) {
Browser[bLower] = c;
}
});
if (Browser.opera) { //Opera9.8后版本号位置变化
ua.replace(/opera.*version\/([\d.]+)/, function(a, b) {
Browser.opera = b;
});
}
if (Browser.msie) {
Browser.ie = Browser.msie;
var v = parseInt(Browser.msie, 10);
Browser['ie' + v] = true;
}
return Browser;
})(),
getDocRect=function(doc){
doc = doc || document;
var win = doc.defaultView || doc.parentWindow,
mode = doc.compatMode,
root = doc.documentElement,
h = win.innerHeight || 0,
scrollX = win.pageXOffset || 0,
scrollY = win.pageYOffset || 0,
scrollW = root.scrollWidth,
scrollH = root.scrollHeight,
offsetW,offsetH;

if (mode != 'CSS1Compat') { // Quirks
root = doc.body;
scrollH = root.scrollHeight;
}

if (mode) { // IE, Gecko
h = root.clientHeight;
}
scrollH = Math.max(scrollH, h);
scrollX = Math.max(scrollX, doc.documentElement.scrollLeft, doc.body.scrollLeft);
scrollY = Math.max(scrollY, doc.documentElement.scrollTop, doc.body.scrollTop);
offsetH = document.body.offsetHeight||document.documentElement.offsetHeight;
return {
height: h,
scrollHeight: scrollH,
scrollX: scrollX,
scrollY: scrollY,
contentHeight:(scrollH == h ? offsetH:scrollH)
};
},
autoAdjustHeight=function(){
var _old_data;
var as=setInterval(function(){
var _docHeight=getDocRect().contentHeight;
if(_docHeight&amp;&amp;_docHeight!=_old_data){

//XNLY.adjustHeight(_docHeight);
_old_data=_docHeight;
document.getElementById("iframeC").src=urlC+"#"+_old_data;
}
},100);
};
autoAdjustHeight();
})();
