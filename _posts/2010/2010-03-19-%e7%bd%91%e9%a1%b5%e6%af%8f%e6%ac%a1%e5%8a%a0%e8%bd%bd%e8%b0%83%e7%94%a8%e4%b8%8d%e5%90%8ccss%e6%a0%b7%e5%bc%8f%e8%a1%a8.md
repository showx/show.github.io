---
layout: post
title: 网页每次加载调用不同CSS样式表 
date: 2010-03-19 09:35
author: admin
comments: true
categories: []
---
在<span style="color: #000000;">上一篇文章中曾提到要给自己的微博客制</span>作多个样式，然后用户每次访问时随机载入样式，让微博在视觉上保持新鲜感。虽然思路与实现都比较简单，但还是想记录下来，与大家分享。

<strong>【明确需求】</strong>
<ol>
	<li>网页加载样式表default.css，会展现默认风格。同时为实现多种风格，制作了skin1.css，skin2.css，skin3.css三种定制样式。如果在加载default.css后，再加载其中某一样式表，则会覆盖默认风格，展示新风格；</li>
	<li>每次随机加载skin1.css、skin2.css、skin3.css，或者使用默认风格。需要注意的一点是，随机加载也有可能使这一次和上一次的样式相同。</li>
</ol>
?

<strong>【实现思路】</strong>
<ol>
	<li>使用document.write动态向中写入css载入语句；</li>
	<li>通过生成的随机数，随机加载样式表；</li>
	<li>使用cookie机制记录当前风格，确保下次下次风格与当前风格一定不同。</li>
</ol>
?

<strong>【实现代码】</strong>
比较简单，我这里就直接贴代码了，里面略加注释：
<div>
<div>
<pre>var Init = {
?
       //样式表文件目录路径
 baseSkinUrl : "/blog/css/skin/",
?
 //样式表文件名称列表
 styles : ["default", "skin1", "skin2", "skin3"],
?
 //样式cookie的key值
 cookieKey : "css9_blog_random_css",
?
 //定义方法，获取min至max间的随机数，包含min及max
 getRandomNum : function(min, max){
  return min + Math.floor(Math.random() * (max - min + 1));  
 },
?
 //定义方法，获取cookie值
 getCookie : function(name) {
  var arr = document.cookie.match(new RegExp("(^　 )" + name + "=([^;]*)(;　$)"));
  if (arr != null) {
   return unescape(arr[2]);
  }
  return null;
 },
?
 //定义方法，设置cookie值
 setCookie : function(sName,sValue,objHours,sPath,sDomain,bSecure){
  var sCookie = sName + "=" + encodeURIComponent(sValue);
  if (objHours) {
   var date = new Date();
   var ms = objHours * 3600 * 1000;
   date.setTime(date.getTime() + ms);
   sCookie += ";expires=" + date.toGMTString();
  }
  if (sPath) {
   sCookie += ";path=" + sPath;
  }
  if (sDomain) {
   sCookie += ";domain=" + sDomain;
  }
  if (bSecure) {
   sCookie += ";secure";
  }
  document.cookie=sCookie;
 },
?
        //定义方法，通过获取随机数随机加载CSS
 loadCSS : function(){
  var length = this.styles.length,
       random = this.getRandomNum(0, length-1),
       cookieStyle = this.getCookie(this.cookieKey),
       currentStyle = "default";
?
  //如果当前随机取到的样式与cookie中样式相同，则重新计算随机数
                while(this.styles[random] == cookieStyle)
  {
   random = this.getRandomNum(0, length-1)
  }
?
  currentStyle = this.styles[random];
?
  //将新样式存入cookie，cookie有效时间为24小时
                this.setCookie(this.cookieKey, currentStyle, 24, "/", "css9.net", false);
?
  //若样式名称不为"default"默认样式，则向标签中写入定制样式
                if(currentStyle != "default")
  {
   document.write('                  href="' + this.baseSkinUrl + this.styles[random] + '.css" /&gt;');
  }  
 }
}
?
Init.loadCSS();   //执行随机加载CSS方法</pre>
</div>
</div>
?

将上面js代码保存为Init.js文件，并在中加载该js文件。

<strong>【查看效果】</strong>
可以去我的<span style="color: #000000;">微博客</span>查看效果，多次刷新效果更好呦? 。现在只有三种样式，以后会逐渐添加更多样式。

<strong>提示：</strong> 如果你的网页中已经使用了jquery，那么可以用我之前介绍的<span style="color: #000000;">jQuery cookie操作插件实现cookie的读写操作，不必再定义代码中的setCookie和getCookie方法。ssssssss</span>
