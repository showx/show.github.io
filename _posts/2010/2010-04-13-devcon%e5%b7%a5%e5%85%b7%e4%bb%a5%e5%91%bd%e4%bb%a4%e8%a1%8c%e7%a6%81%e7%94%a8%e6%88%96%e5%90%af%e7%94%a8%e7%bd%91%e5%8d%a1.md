---
layout: post
title: DevCon工具以命令行禁用或启用网卡 
date: 2010-04-13 15:24
author: admin
comments: true
categories: []
---
聪明人往往很懒，懒到多点几下鼠标就觉得浑身不舒服。 　　

　　对于禁用和启用网卡，找到控制面板的网络设置里面就可以搞定的，但他们偏偏不，就要用批处理实现，好吧，微软的 DevCon 工具就可以命令行禁用或启用网卡，下面是两个批处理的例子——

　　@echo off 　　

　　devcon disable *DEV_8136* 　　

　　devcon enable *DEV_8136* 　　

　　echo on 　　

　　首先到微软的网站下载一个批处理软件（如果你电脑中有的话就不用了，你去找一下，这文件在WINDOWS目录的SYSTEM32文件夹下）：http://download.microsoft.com/download/1/1/f/11f7dd10-272d-4cd2-896f-9ce67f3e0240/devcon.exe 　　

　　下载后放在system32目录下 　　

　　然后在运行内输入cmd打开dos窗口 　　

　　输入devcon find pci＼* 　　

　　列出本地计算机上所有已知的PCI 设备,如下，这是本人的网卡一行 　　

　　PCI＼VEN_13F0&amp;DEV_0201&amp;SUBSYS_020113F0&amp;REV_14＼3&amp;13C0B0C5&amp;0&amp;48: Sundance ST201 based PCI Fast Ethernet Adapter #3 　　

　　记下第一个&amp;和第二个&amp;之间的设备代码，例如我的网卡就是：DEV_0201
　　
　　批处理脚本如下： 　　

　　devcon disable *DEV_0201* //禁用此PCI设备 　　

　　devcon enable *DEV_0201* //启用此PCI设备 　　

　　DevCon 实用工具是一种命令行实用工具，可以替代设备管理器。使用 DevCon，您可以启用、禁用、重新启动、更新、删除和查询单个设备或一组设备。DevCon 还提供与驱动程序开发人员有关、但无法在设备管理器中看到的信息。可以将 DevCon 用于 Microsoft Windows 2000、Windows XP 和 Windows Server 2003、Vista和Windows7，但不能将其用于 Windows 95、Windows 98 或 Windows Millennium Edition。 　　

　　一般情况下的用法：(介绍几个常用的命令和语法) 　　

　　1、devcon find 　　

　　devcon find * [这个命令可以列出列出本地计算机上存在的所有设备的设备实例] 　　

　　devcon find pci＼* [列出本地计算机上所有已知的“外围组件互连”(PCI) 设备（如果一个设备的硬件 ID 以“PCI＼”为前缀，此命令就认为该设备是 PCI 设备] 　　

　　2、devcon disable *msloop [禁用硬件 ID 以“MSLOOP”结尾（包括“*MSLOOP”）的所有设备]

　　3、devcon enable '*MSLOOP 　　

　　[启用硬件 ID 为“*MSLOOP”的所有设备。单引号指示必须严格按字面解释硬件 ID（换句话说，星号 [“*”] 真的是 一个星号，而不是通配符] 　　

　　4、devcon remove @usb＼* 　　

　　删除所有 USB 设备。被删除的设备列出时将显示其删除状态因为下面要讲一个实例，所以先说说硬件ID是啥玩艺，说实在的就是让大家知道怎么找出它，请看： 　　

　　find pci＼* 下面就是找出的一部分: 　　

　　PCI＼VEN_10EC&amp;DEV_8139&amp;SUBSYS_813910EC&amp;REV_10＼3&amp;13C0B0C5&amp;0&amp;58: Realtek RTL8139 Family PCI Fast Ethernet NIC 　　

　　PCI＼VEN_1106&amp;DEV_0571&amp;SUBSYS_18271019&amp;REV_06＼3&amp;13C0B0C5&amp;0&amp;89: VIA Bus Master IDE Controller 　　

　　PCI＼VEN_1106&amp;DEV_3038&amp;SUBSYS_18271019&amp;REV_80＼3&amp;13C0B0C5&amp;0&amp;80: VIA Rev 5 or later USB Universal Host Controller 　　

　　这几行“：”前面的就是硬件ID，后面是设备名称. 　　

　　偶要禁用网卡了，请看仔细： 　　

　　devcon disable *DEV_8139* [就这样就行了，前提是你电脑里有devcon.exe] 　

　　偶要启用它了，同样的搞一下： devcon enable *DEV_8139* 　　

　　如果您指定 -r 并且需要重新启动，则在处理完所有设备后，将在无任何警告信息的情况下重新启动就行了，其它的就不多说了，大家喜欢用的话就去下载一个压缩包在自己机子上用用吧，有些人可能想它要是有更强大的功能，就请各位自力更生……相信自己! 　　

　　压缩包里是2个文件夹，一个是32 位用的，一个是64位用的， 　　

　　DevCon.exe 文件包含以下文件： 　　

　　文件 说明 　　

　　I386＼DevCon.exe 32 位 DevCon 工具的可执行文件。此文件在 64 位 Windows 上不能充分发挥作用。 　　

　　Ia64＼DevCon.exe 64 位 DevCon 工具的可执行文件
