<!DOCTYPE HTML>
<html>
<head>
	<meta charset="utf-8">
	<title>  
	  
  	服务端 - shengsheng的博客
  	
	</title>

  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

	<link href="atom.xml" rel="alternate" title="shengsheng的博客" type="application/atom+xml">

	<link href="asset/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
	<link href="asset/stylesheets/font-awesome.min.css" media="screen, projection" rel="stylesheet" type="text/css">
	<script src="asset/javascripts/jquery.min.js"></script>
	

	<!--[if lt IE 9]><script src="asset/javascripts/html5.js"></script><![endif]-->
	<!-- <link href='http://fonts.googleapis.com/css?family=Nunito:400,300,700' rel='stylesheet' type='text/css'> -->
	<style type="text/css">
/* latin */
@font-face {
  font-family: 'Nunito';
  font-style: normal;
  font-weight: 300;
  src: local('Nunito-Light'), url(asset/font/1TiHc9yag0wq3lDO9cw0voX0hVgzZQUfRDuZrPvH3D8.woff2) format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215, U+E0FF, U+EFFD, U+F000;
}
/* latin */
@font-face {
  font-family: 'Nunito';
  font-style: normal;
  font-weight: 400;
  src: local('Nunito-Regular'), url(asset/font/6TbRXKWJjpj6V2v_WyRbMX-_kf6ByYO6CLYdB4HQE-Y.woff2) format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215, U+E0FF, U+EFFD, U+F000;
}
/* latin */
@font-face {
  font-family: 'Nunito';
  font-style: normal;
  font-weight: 700;
  src: local('Nunito-Bold'), url(asset/font/TttUCfJ272GBgSKaOaD7KoX0hVgzZQUfRDuZrPvH3D8.woff2) format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215, U+E0FF, U+EFFD, U+F000;
}
	</style>
	
	<style type="text/css">
	.container .left-col{ opacity: 1;}
	#pagenavi a{ font-size: 1.3em;}
	#pagenavi .next:before{ top: 3px;}
	#pagenavi .prev:before{ top: 3px;}
	.container .mid-col .mid-col-container #content .archives .title{ font-size: 1.5em;}
	.container .mid-col .mid-col-container #content article{ padding: 15px 0px;}
	#header .subtitle {
		line-height: 1.2em;
		padding-top: 8px;
	}
	article pre{ background: none; border: none; padding: 0;}
	article .entry-content{text-align: left;}
	.share-comment{ padding: 25px 0px; clear: both;}
	hr{ margin: 20px 0px;border: 0; border-top:solid 1px #ddd;}
	</style>
  

</head>


<body>
	<div class="container">
		<div class="left-col">
			<div class="intrude-less">
				<header id="header" class="inner">
				 
					
					<h1><a href="index.html">shengsheng的博客</a></h1>
					<p class="subtitle">脚本技术员博客</p>
					<nav id="main-nav">
						<ul class="main">
						
						  <li id=""><a target="self" href="index.html">Home</a></li>
						
						  <li id=""><a target="_self" href="archives.html">Archives</a></li>
						
						</ul>
					</nav>

					<nav id="sub-nav">
						<div class="social">










<a target="_blank" class="github" target="_blank" href="https://github.com/showx" title="GitHub">GitHub</a>
<a target="_blank" class="email" href="mailto:9448923#qq.com" title="Email">Email</a>

								

								<a class="rss" href="atom.xml" title="RSS">RSS</a>
							
						</div>
					</nav>
				</header>				
			</div>
		</div>	
		<div class="mid-col">
			<div class="mid-col-container"> <div id="content" class="inner">
<div itemscope itemtype="http://schema.org/Blog">


	<article class="post" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
		<div class="meta">
			<div class="date">
				<time datetime="2017-04-18T04:33:42+08:00" itemprop="datePublished">2017/04/18</time>
			</div>
			<div class="tags">posted in 
			
			    <a class='category' href='server.html'>服务端</a>&nbsp;
			 
			</div>
		</div>
		<h1 class="title" itemprop="name"><a href="15809578629394.html" itemprop="url">
		mysql PARTITION表分区要注意事项</a></h1>
		<div class="entry-content" itemprop="articleBody">
			
			<p>date: 2017-04-18 16:33</p>

<p>把表进行分区，数据量有一定的时候，会减轻压力。</p>

<p>1.主键，一定要使用复合主键。例如，主键为id, 复合字段就是 id,date</p>

<p>2.按月进行分区，其它没区分出的，放在MAXVALUE</p>

<p>3.写个shell crond,每个月设置一次。</p>

<p>例:</p>

<p>alter table day PARTITION by range(itime_d div 100)<br/>
(<br/>
partition day_2017_01 values less than (201701),<br/>
partition day_2017_02 values less than (201702),<br/>
partition day_2017_03 values less than (201703),<br/>
PARTITION day_2017_04 VALUES less than MAXVALUE<br/>
);</p>


			
			
		</div>

	</article>
 
	<article class="post" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
		<div class="meta">
			<div class="date">
				<time datetime="2017-04-12T02:10:42+08:00" itemprop="datePublished">2017/04/12</time>
			</div>
			<div class="tags">posted in 
			
			    <a class='category' href='server.html'>服务端</a>&nbsp;
			 
			</div>
		</div>
		<h1 class="title" itemprop="name"><a href="15809578629442.html" itemprop="url">
		数据库区分大小写问题</a></h1>
		<div class="entry-content" itemprop="articleBody">
			
			<p>date: 2017-04-12 02:10</p>

<p>其实关于自己选择集有关</p>

<p>例如列有:</p>

<p>user</p>

<p>gw</p>

<p>GW</p>

<p>查询时候group by user，只有GW</p>

<p>ALTER TABLE table CHANGE COLUMN <code>user</code> <code>user</code> varchar(100) CHARACTER SET utf8 COLLATE utf8_bin DEFAULT NULL COMMENT &#39;名称&#39;;</p>

<p>改变collate就会区分大小写的了</p>

<p>设置collate（校对） 。 collate规则：</p>

<p>*_bin: 表示的是binary case sensitive collation，也就是说是区分大小写的<br/>
*_cs: case sensitive collation，区分大小写<br/>
*_ci: case insensitive collation，不区分大小写</p>

<p>对于只是单项查询区分，使用binary就可够了。 where user binary(&#39;gw&#39;);</p>

<p>sql的一个例子：</p>

<p>select user collate utf8_bin from table group by user collate utf8_bin;</p>


			
			
		</div>

	</article>
 
	<article class="post" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
		<div class="meta">
			<div class="date">
				<time datetime="2015-11-18T10:57:43+08:00" itemprop="datePublished">2015/11/18</time>
			</div>
			<div class="tags">posted in 
			
			    <a class='category' href='server.html'>服务端</a>&nbsp;
			 
			</div>
		</div>
		<h1 class="title" itemprop="name"><a href="15809578630724.html" itemprop="url">
		今天工作遇到的小问题总结</a></h1>
		<div class="entry-content" itemprop="articleBody">
			
			<p>date: 2015-11-18 19:21</p>

<p>InnoDB: Unable to lock ./ibdata1, error: 11<br/>
InnoDB: Check that you do not already have another mysqld process<br/>
InnoDB: using the same InnoDB data or log files.<br/>
不使用/etc/init.d/mysql restart<br/>
使用service mysql restart 即可</p>

<p>setcookie 如果时间设置为0,即session就过期</p>


			
			
		</div>

	</article>
 
	<article class="post" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
		<div class="meta">
			<div class="date">
				<time datetime="2015-11-05T10:57:43+08:00" itemprop="datePublished">2015/11/05</time>
			</div>
			<div class="tags">posted in 
			
			    <a class='category' href='server.html'>服务端</a>&nbsp;
			 
			</div>
		</div>
		<h1 class="title" itemprop="name"><a href="15809578631013.html" itemprop="url">
		mysql update不了原因</a></h1>
		<div class="entry-content" itemprop="articleBody">
			
			<p>date: 2015-11-05 11:25</p>

<p>update bone_m_element set thumb=CONCAT(thumb,&#39;dia.jpg&#39;) where thumb like &#39;%gju%&#39;</p>

<p>update不了的原因是 char(100) 不够长，改为 char(200)即可</p>


			
			
		</div>

	</article>
 
	<article class="post" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
		<div class="meta">
			<div class="date">
				<time datetime="2015-11-03T10:57:43+08:00" itemprop="datePublished">2015/11/03</time>
			</div>
			<div class="tags">posted in 
			
			    <a class='category' href='server.html'>服务端</a>&nbsp;
			
			    <a class='category' href='script.html'>脚本</a>&nbsp;
			 
			</div>
		</div>
		<h1 class="title" itemprop="name"><a href="15809578631093.html" itemprop="url">
		if empty打错字的后果。</a></h1>
		<div class="entry-content" itemprop="articleBody">
			
			<p>date: 2015-11-03 14:04</p>

<p>打错字：<br/>
if(empty(\(a &amp;&amp; empty(\)b))<br/>
{</p>

<p>}<br/>
//不符合条件也是对的<br/>
正确的话：<br/>
if(empty(\(a) &amp;&amp; empty(\)b))<br/>
{</p>

<p>}</p>

<p>// \(b = &quot;123&quot;;<br/>
// \)c = &quot;567&quot;;<br/>
// \(a = empty(\)b &amp;&amp; false);<br/>
// var_dump($a);exit();</p>

<p>// if( false &amp;&amp; false)<br/>
// {<br/>
//     echo &#39;ok&#39;;exit();<br/>
// }else{<br/>
//     echo &#39;no&#39;;exit();<br/>
// }</p>


			
			
		</div>

	</article>
 
	<article class="post" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
		<div class="meta">
			<div class="date">
				<time datetime="2015-10-31T10:57:43+08:00" itemprop="datePublished">2015/10/31</time>
			</div>
			<div class="tags">posted in 
			
			    <a class='category' href='server.html'>服务端</a>&nbsp;
			 
			</div>
		</div>
		<h1 class="title" itemprop="name"><a href="15809578631182.html" itemprop="url">
		mysql的一些小问题</a></h1>
		<div class="entry-content" itemprop="articleBody">
			
			<p>date: 2015-10-31 09:29</p>

<p>直接mysqld启动没socket，<br/>
有时为了方便直接使用mysqld,但socket文件没创建，要保证运行顺畅，还是使用mysqld_safe启动。</p>


			
			
		</div>

	</article>
 
	<article class="post" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
		<div class="meta">
			<div class="date">
				<time datetime="2015-08-17T10:57:43+08:00" itemprop="datePublished">2015/08/17</time>
			</div>
			<div class="tags">posted in 
			
			    <a class='category' href='server.html'>服务端</a>&nbsp;
			 
			</div>
		</div>
		<h1 class="title" itemprop="name"><a href="15809578635146.html" itemprop="url">
		docker vagrant页面错误解决</a></h1>
		<div class="entry-content" itemprop="articleBody">
			
			<p>date: 2015-08-17 21:27</p>

<p>之前提到说通过Vagrant部署开发环境，使用目录共享模式，在本地磁盘进行开发，而通过虚拟机环境运行开发的页面。</p>

<p>是的，一切看起来都是那么的顺利，首先基于VirtualBox安装了Vagrant，接下来，按照以往部署环境的习惯，在VM中安装了nginx作为开发运行环境，并且将本地的共享目录作为nginx的web目录，然后打开页面，看上去似乎都很正常，但接下来，你发现了一个神奇的事情，你修改替换了一个css，一张图片，然后刷新浏览器，发现什么都没有变，然后你有非常猛烈、使劲的F5，依旧还是没有改变，是的，你看看编辑器，似乎替换是正常的，在看看VM上的文件，也都是对的，是的，尝试重启nginx，依旧没有任何变化，你开始怀疑php5-fpm甚至于毫不相干的memcached和mysql，但都无济于事。也不知道是什么让这些文件被“缓存”了呢。</p>

<p>当你尝试修改一个js，并且用同样的方法更新之后，会遇到类似的问题，是的，就算重启VM上任何服务，甚至重启VM，依旧没有用，当然，比起其他资源文件，浏览器的反应会强烈一些，因为浏览器会提示未知错误，而你通过浏览器查看你修改的JS文件，会看到文件尾巴有下面奇怪的随机字符：</p>

<p>�����������������</p>

<p>这到底是什么东西呢？编码错误？缓存异常？又或是其他什么？</p>

<p>是的，你尝试花费很多时间，试验各种各样的方法去解决这个问题，其实对于nginx来说，你只需要修改配置文件(nginx.conf)中的一行重启就能简单的解决这个问题：</p>

<p>sendfile off;<br/>
找到 nginx.conf ，把里面的 “sendfile on” 修改为 “sendfile off”。</p>

<p>当然，如果你使用Apache也可能遇到类似的问题，那么同样也有类似的配置需要修改：</p>

<p>EnableSendfile off</p>

<p>＝＝＝＝＝<br/>
<a href="http://stackoverflow.com/questions/9479117/vagrant-virtualbox-apache2-strange-cache-behaviour">http://stackoverflow.com/questions/9479117/vagrant-virtualbox-apache2-strange-cache-behaviour</a></p>


			
			
		</div>

	</article>
 
	<article class="post" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
		<div class="meta">
			<div class="date">
				<time datetime="2015-08-06T10:57:43+08:00" itemprop="datePublished">2015/08/06</time>
			</div>
			<div class="tags">posted in 
			
			    <a class='category' href='server.html'>服务端</a>&nbsp;
			 
			</div>
		</div>
		<h1 class="title" itemprop="name"><a href="15809578635768.html" itemprop="url">
		mysql复制表结构和数据</a></h1>
		<div class="entry-content" itemprop="articleBody">
			
			<p>date: 2015-08-06 17:12</p>

<p>mysql的完全复制表结构和数据的方法是：<br/>
1、先复制表结构。<br/>
create table 新表 like 旧表<br/>
2、复制数据。<br/>
insert into 新表 select * from 旧表（表结构一致）<br/>
insert into 新表(字段1,字段2,……) select 字段1,字段2,…… from 旧表(表结构不一致)</p>

<p>而像网上说的create table 新表 select * from 旧表 这种方法，复制的表结构不全。索引，id自动增长这些都没有复制到，不知是什么原因。</p>


			
			
		</div>

	</article>
 
	<article class="post" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
		<div class="meta">
			<div class="date">
				<time datetime="2015-08-03T10:57:43+08:00" itemprop="datePublished">2015/08/03</time>
			</div>
			<div class="tags">posted in 
			
			    <a class='category' href='server.html'>服务端</a>&nbsp;
			 
			</div>
		</div>
		<h1 class="title" itemprop="name"><a href="15809578636216.html" itemprop="url">
		linux小技巧</a></h1>
		<div class="entry-content" itemprop="articleBody">
			
			<p>date: 2015-08-03 09:55</p>

<p>就修改/etc/iptables.up.rules<br/>
然后用<br/>
iptables-restore &lt; /etc/iptables.up.rules</p>

<p>dns:<br/>
有两个方法，一是在<br/>
/etc/network/interfaces<br/>
加上<br/>
dns-nameservers 114.114.114.114 8.8.8.8<br/>
要么是修改<br/>
/etc/resolv.conf<br/>
加上<br/>
nameserver 114.114.114.114<br/>
nameserver 8.8.8.8</p>

<p>重启网络：<br/>
/etc/init.d/networking restart</p>

<p>GRANT ALL PRIVILEGES ON * . * TO &#39;root&#39;@&#39;%&#39; WITH GRANT OPTION MAX_QUERIES_PER_HOUR 0 MAX_CONNECTIONS_PER_HOUR 0 MAX_UPDATES_PER_HOUR 0MAX_USER_CONNECTIONS 0 ;</p>

<p>打包时用<br/>
tar zcvf 文件名.tar.gz 目标目录<br/>
解压时用<br/>
tar xzvf 文件名.tar.gz<br/>
文件名别用中文</p>

<p>rsync -vrtopg --delete --size-only --progress  rsync://121.10.140.92:873  /www/</p>


			
			
		</div>

	</article>
 
	<article class="post" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
		<div class="meta">
			<div class="date">
				<time datetime="2015-07-08T10:57:43+08:00" itemprop="datePublished">2015/07/08</time>
			</div>
			<div class="tags">posted in 
			
			    <a class='category' href='server.html'>服务端</a>&nbsp;
			 
			</div>
		</div>
		<h1 class="title" itemprop="name"><a href="15809578638997.html" itemprop="url">
		Linux下su与su -命令的本质区别</a></h1>
		<div class="entry-content" itemprop="articleBody">
			
			<p>date: 2015-07-08 15:59</p>

<p>本人以前一直习惯直接使用root，很少使用su，前几天才发现su与su -命令是有着本质区别的！<br/>
大部分Linux发行版的默认账户是普通用户，而更改系统文件或者执行某些命令，需要root身份才能进行，这就需要从当前用户切换到root用户。Linux中切换用户的命令是su或su -。前天我在使用useradd这个命令时，才体会到这两者的本质区别。如图：</p>

<p>我首先是用su命令切换到root身份的，但是运行useradd时，出现错误：bash: useradd: command not found。google了一下，原因是在这个用su命令切换过来的root用户上。</p>

<p>su命令和su -命令最大的本质区别就是：前者只是切换了root身份，但Shell环境仍然是普通用户的Shell；而后者连用户和Shell环境一起切换成root身份了。只有切换了Shell环境才不会出现PATH环境变量错误。su切换成root用户以后，pwd一下，发现工作目录仍然是普通用户的工作目录；而用su -命令切换以后，工作目录变成root的工作目录了。用echo $PATH命令看一下su和su -以后的环境变量有何不同。以此类推，要从当前用户切换到其它用户也一样，应该使用su -命令。</p>


			
			
		</div>

	</article>
 
	<article class="post" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
		<div class="meta">
			<div class="date">
				<time datetime="2015-07-06T10:57:43+08:00" itemprop="datePublished">2015/07/06</time>
			</div>
			<div class="tags">posted in 
			
			    <a class='category' href='server.html'>服务端</a>&nbsp;
			 
			</div>
		</div>
		<h1 class="title" itemprop="name"><a href="15809578639403.html" itemprop="url">
		windows下建立文件的换行符^M导致linux下的shell脚本运行错误的解决方案</a></h1>
		<div class="entry-content" itemprop="articleBody">
			
			<p>date: 2015-07-06 11:13</p>

<p>ows下编辑的文件远程传送到linux下的时候每行末尾都会出现<sup>M，这将导致shell脚本运行错误，主要是因为<strong>dos下的编辑器和linux下的编辑器对文件末行的回车符处理不一致导致</strong>。</sup></p>

<p>主要解决如下：</p>

<p>（1）<strong>在VI编辑器中将<sup>M删除</strong>：</sup></p>

<p>将VI编辑器切换到命令模式下，输入 :%s/<sup>M//g</sup> (注意<sup>M</sup> 不是shift ^ +M 而是ctrl+v 加上ctrl+m)  <strong>s///g</strong>是shell的<strong>替换</strong>命令</p>

<p>此命令必须是手动打上，不可复制。</p>

<p>（2）<strong>dos2unix 命令</strong></p>

<p>dos2unix filename</p>

<p>（2）使用支持修改换行符的编辑器另存为一下文件,比如emeditor<br/>
<img src="http://img.phperz.com/data/img/20141013/14131927807518.jpg" alt="" /></p>


			
			
		</div>

	</article>
 
	<article class="post" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
		<div class="meta">
			<div class="date">
				<time datetime="2015-06-16T10:57:44+08:00" itemprop="datePublished">2015/06/16</time>
			</div>
			<div class="tags">posted in 
			
			    <a class='category' href='server.html'>服务端</a>&nbsp;
			 
			</div>
		</div>
		<h1 class="title" itemprop="name"><a href="15809578641037.html" itemprop="url">
		nginx php 配置好后网页输出空白</a></h1>
		<div class="entry-content" itemprop="articleBody">
			
			<p>date: 2015-06-16 15:22</p>

<p>查看了 nginx 和 php-fpm 的日志文件，都没有发现错误。实在是奇怪。</p>

<p>factcgi_params<br/>
搜索后解决了问题：在 location ~ .php$ {} 配置里加上如下一行：</p>

<p>fastcgi_param SCRIPT_FILENAME \(document_root\)fastcgi_script_name;</p>


			
			
		</div>

	</article>
 
	<article class="post" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
		<div class="meta">
			<div class="date">
				<time datetime="2015-04-07T10:57:44+08:00" itemprop="datePublished">2015/04/07</time>
			</div>
			<div class="tags">posted in 
			
			    <a class='category' href='server.html'>服务端</a>&nbsp;
			 
			</div>
		</div>
		<h1 class="title" itemprop="name"><a href="15809578643618.html" itemprop="url">
		INSERT IGNORE 与INSERT INTO的区别</a></h1>
		<div class="entry-content" itemprop="articleBody">
			
			<p>date: 2015-04-07 14:49</p>

<p>INSERT IGNORE 与INSERT INTO的区别就是INSERT IGNORE会忽略数据库中已经存在 的数据，如果数据库没有数据，就插入新的数据，如果有数据的话就跳过这条数据。这样就可以保留数据库中已经存在数据，达到在间隙中插入数据的目的。<br/>
eg:<br/>
insert ignore into table(name)  select  name from table2</p>


			
			
		</div>

	</article>
 
	<article class="post" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
		<div class="meta">
			<div class="date">
				<time datetime="2015-01-24T10:57:44+08:00" itemprop="datePublished">2015/01/24</time>
			</div>
			<div class="tags">posted in 
			
			    <a class='category' href='server.html'>服务端</a>&nbsp;
			 
			</div>
		</div>
		<h1 class="title" itemprop="name"><a href="15809578646516.html" itemprop="url">
		rsync苦恼</a></h1>
		<div class="entry-content" itemprop="articleBody">
			
			<p>date: 2015-01-24 17:18</p>

<p>rsync connect timeout</p>

<p>找了很久才发现ip不对。－ －！</p>

<p>再次提醒自己</p>

<p>ip对清楚</p>

<p>端口对清楚</p>

<p>ip是否允许</p>

<p>rsync服务是否启动</p>

<p>服务也对清楚</p>


			
			
		</div>

	</article>
 
	<article class="post" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
		<div class="meta">
			<div class="date">
				<time datetime="2015-01-21T10:57:44+08:00" itemprop="datePublished">2015/01/21</time>
			</div>
			<div class="tags">posted in 
			
			    <a class='category' href='server.html'>服务端</a>&nbsp;
			 
			</div>
		</div>
		<h1 class="title" itemprop="name"><a href="15809578647314.html" itemprop="url">
		关于xhprof</a></h1>
		<div class="entry-content" itemprop="articleBody">
			
			<p>date: 2015-01-21 15:11</p>

<p>xhprof_enable();</p>

<p>debug_hanlde_xhprof();</p>

<p>xhprof主要有这些</p>

<p>如果xhprof信息输出不了</p>

<p>xhprof.output_dir=  要注册xhprof输出的文件夹</p>


			
			
		</div>

	</article>
 
	<article class="post" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
		<div class="meta">
			<div class="date">
				<time datetime="2014-12-04T10:57:45+08:00" itemprop="datePublished">2014/12/04</time>
			</div>
			<div class="tags">posted in 
			
			    <a class='category' href='server.html'>服务端</a>&nbsp;
			 
			</div>
		</div>
		<h1 class="title" itemprop="name"><a href="15809578651810.html" itemprop="url">
		shell笔记 以文件之名</a></h1>
		<div class="entry-content" itemprop="articleBody">
			
			<p>date: 2014-12-04 23:02</p>

<p>tree<br/>
tree PATH -H http://localhost -o out.html 输出目录结构</p>

<p>sed &#39;s/<sup>\t//&#39;</sup></p>

<p>mount umount</p>

<p>wc -l</p>

<p>pushd <br/>
dirs<br/>
popd</p>

<p>head tail</p>

<p>diff<br/>
patch</p>

<p>eject<br/>
eject -t</p>

<p>dd if=/dev/cdrom of=image.iso<br/>
环回文件<br/>
mkfs.ext4 loopbackfile.img</p>

<p>kpartx -v -a diskimage.img</p>

<p>file -b 列出文件类型</p>

<p>comm  交集与差集 </p>

<p>ls -l<br/>
第一列第一个字母：</p>

<ul>
<li>普通文件<br/>
d 目录<br/>
c  字符设备<br/>
b 块设备<br/>
l 符号连接<br/>
s 套接字<br/>
p 管道</li>
</ul>

<p>if [ $# -ne 1]</p>


			
			
		</div>

	</article>
 
	<article class="post" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
		<div class="meta">
			<div class="date">
				<time datetime="2014-11-12T10:57:45+08:00" itemprop="datePublished">2014/11/12</time>
			</div>
			<div class="tags">posted in 
			
			    <a class='category' href='server.html'>服务端</a>&nbsp;
			 
			</div>
		</div>
		<h1 class="title" itemprop="name"><a href="15809578654241.html" itemprop="url">
		复习linux笔记</a></h1>
		<div class="entry-content" itemprop="articleBody">
			
			<p>date: 2014-11-12 23:21</p>

<p>chgrp 用户组<br/>
chown 所有者<br/>
chown 文件权限 </p>

<p>r = read<br/>
w = write<br/>
x = excute<br/>
rwxrwxrwx<br/>
owner group others<br/>
u g o a<br/>
owner = u<br/>
group = g<br/>
others = o<br/>
all = a (所有者)<br/>
r=4<br/>
w=2<br/>
x=1</p>

<p>umask文件默认权限</p>

<p>文件隐藏属性 <br/>
chattr <br/>
lsattr</p>

<p>SUID,SGID,SBIT</p>

<p>file<br/>
which<br/>
whereis<br/>
locate</p>


			
			
		</div>

	</article>
 
	<article class="post" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
		<div class="meta">
			<div class="date">
				<time datetime="2014-10-27T10:57:45+08:00" itemprop="datePublished">2014/10/27</time>
			</div>
			<div class="tags">posted in 
			
			    <a class='category' href='server.html'>服务端</a>&nbsp;
			 
			</div>
		</div>
		<h1 class="title" itemprop="name"><a href="15809578654890.html" itemprop="url">
		mysql查找id用逗号连接</a></h1>
		<div class="entry-content" itemprop="articleBody">
			
			<p>date: 2014-10-27 11:07</p>

<p>如：<br/>
select id from tab;<br/>
结果是<br/>
1<br/>
2<br/>
3<br/>
我需要1,2,3</p>

<p>解决办法：</p>

<p>select Group_concat(id) from tab;</p>

<p>select group_concat(id order by id asc separator &#39;,&#39;) from tb;</p>


			
			
		</div>

	</article>
 
	<article class="post" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
		<div class="meta">
			<div class="date">
				<time datetime="2014-09-25T10:57:45+08:00" itemprop="datePublished">2014/09/25</time>
			</div>
			<div class="tags">posted in 
			
			    <a class='category' href='server.html'>服务端</a>&nbsp;
			 
			</div>
		</div>
		<h1 class="title" itemprop="name"><a href="15809578655625.html" itemprop="url">
		利用SVN的POST-COMMIT钩子自动部署代码</a></h1>
		<div class="entry-content" itemprop="articleBody">
			
			<p>date: 2014-09-25 20:50</p>

<p>利用SVN的POST-COMMIT钩子自动部署代码</p>

<p>我们在开发的过程将代码提交到SVN后使用SVN的hook，通过post-commit脚本，在目<br/>
标文件夹根下执行svn update操作，将更新内容同步到测试环境，这样开发调试非常方便。</p>

<h2 id="toc_0">post-commit内容：</h2>

<h1 id="toc_1">!/bin/sh</h1>

<h1 id="toc_2">修改为服务编码</h1>

<p>export LANG=zh_CN.gb2312</p>

<h1 id="toc_3">Set variable</h1>

<p>REPOS=&quot;\(1&quot;<br/>
REV=&quot;\)2&quot;</p>

<p>SVN=/usr/bin/svn<br/>
WEB=/data/home/htdocs<br/>
LOG=/data/home/auto_svn.log</p>

<h1 id="toc_4">update the code from the SVN</h1>

<p>\(SVN update \)WEB --username username --password password --non-interactive</p>

<h1 id="toc_5">......................</h1>

<p>if [ $? == 0 ]<br/>
then</p>

<pre><code class="language-text">echo  &quot;$REPOS&quot; &quot;$REV&quot; &gt;&gt; $LOG
echo `date` &gt;&gt; $LOG
echo &quot;##############################&quot; &gt;&gt; $LOG
</code></pre>

<h2 id="toc_6">fi</h2>

<p>需要注意：<br/>
1、需要用export指定编码。<br/>
2、需要指定svn全路径。<br/>
3、代码CO出来之后，可以进行post-commit脚本的测试了。因为svn的hooks执行的时候不带有任何的环境变量，所以我们不能通过简单的 ./post-commit 进行代码的测试。必须要使用sudo su 等命令切换到svn或者apache服务器运行用户下，用下面的方法进行测试<br/>
Python代码<br/><br/>
env – ./post-commit  </p>


			
			
		</div>

	</article>
 
	<article class="post" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
		<div class="meta">
			<div class="date">
				<time datetime="2014-09-04T10:57:45+08:00" itemprop="datePublished">2014/09/04</time>
			</div>
			<div class="tags">posted in 
			
			    <a class='category' href='server.html'>服务端</a>&nbsp;
			 
			</div>
		</div>
		<h1 class="title" itemprop="name"><a href="15809578656683.html" itemprop="url">
		Nginx ssi 设置</a></h1>
		<div class="entry-content" itemprop="articleBody">
			
			<p>date: 2014-09-04 16:46</p>

<p>一：为什么用ssi?</p>

<p>一个登录用户在页面访问的时候如何充分利用 cache?</p>

<p>页面静态化的一个大问题是登录用户访问页面如何静态化。例如首页，大部分的页面内容需要缓存但是用户登录后的个人信息是动态信息，不能缓存。那么如何解决这个&quot;页面部分缓存&quot;问题？</p>

<p>现有的方案是利用 SSI - Server Side include.</p>

<p>Nginx SSI 实现是 <a href="http://wiki.nginx.org/NginxHttpSsiModule">http://wiki.nginx.org/NginxHttpSsiModule</a></p>

<p>这里最关键的就是静态文件可以包含一个动态的网页的 URL.</p>

<p>二：配置ssi</p>

<p>主要是三个参数，ssi，ssi_silent_errors和ssi_types，均可以放在http,server和location的作用域下。</p>

<p>ssi on<br/>
开启ssi支持，默认是off</p>

<p>ssi_silent_errors on<br/>
默认值是off，开启后在处理SSI文件出错时不输出错误提示:&quot;[an error occurred while processing the directive] &quot;</p>

<p>ssi_types <br/>
默认是ssi_types text/html，所以如果需要htm和html支持，则不需要设置这句，如果需要shtml支持，则需要设置：ssi_types text/shtml</p>

<p>SSI的格式：<br/>
&lt; !--#include file=&quot;bottom.htm&quot;--&gt;<br/>
或<br/>
&lt; !--#include virtual=&quot;/hx/bottom.htm&quot;--&gt;<br/>
路径是相对server中root根目录。</p>

<p>更多请参见官方文档：<a href="http://wiki.nginx.org/NginxChsHttpSsiModule">http://wiki.nginx.org/NginxChsHttpSsiModule</a></p>

<p>示例：</p>

<p>1.开启shtml后缀的文件名支持ssi<br/>
server{<br/>
    ......<br/>
    ssi on;<br/>
    ssi_silent_errors on;<br/>
    ssi_types text/shtml;<br/>
}</p>

<p>2.开启html后缀的文件名支持ssi<br/>
server{<br/>
    ......<br/>
    ssi on;<br/>
    ssi_silent_errors on;<br/>
}</p>

<p>3.在zt目录下开启html后缀的文件名支持ssi<br/>
server{<br/>
    ......<br/>
    location /hx/{<br/>
        ssi on;<br/>
        ssi_silent_errors on;<br/>
    }<br/>
}</p>


			
			
		</div>

	</article>
 
	<article class="post" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
		<div class="meta">
			<div class="date">
				<time datetime="2013-10-09T10:57:46+08:00" itemprop="datePublished">2013/10/09</time>
			</div>
			<div class="tags">posted in 
			
			    <a class='category' href='server.html'>服务端</a>&nbsp;
			 
			</div>
		</div>
		<h1 class="title" itemprop="name"><a href="15809578663859.html" itemprop="url">
		Mysql的varchar排序按照数字顺序</a></h1>
		<div class="entry-content" itemprop="articleBody">
			
			<p>date: 2013-10-09 14:41</p>

<p>自己建表的时候，把一个字段类型创建为varchar(2) ，其实应该建为int(2)的。因为我只允许输出数字。这本来也没什么，无非就是占点空间，懒得改了。但是今天在后台发现排序有问题。于是，没办法，改之。下面简单说一下MySQL的varchar排序问题，引以为戒。<br/>
下面，我从数据库里面以server_id排一下序，大家来看一下排序后的结果：<br/>
select server_id from cardserver where game_id = 1 order by server_id desc limit 10;<br/>
+-----------+<br/>
| server_id |<br/>
+-----------+<br/>
| 8         | <br/>
| 7         | <br/>
| 6         | <br/>
| 5         | <br/>
| 4         | <br/>
| 3         | <br/>
| 2         | <br/>
| 10        | <br/>
| 1         | <br/>
+-----------+</p>

<p>很明显，我想要的结果应该是 10,8,7,6,5 这样的。但是这个10排在了2的后面。按照字符串来排的。其实我是想把它当做数值来排。<br/>
手动转换类型：<br/>
用下面的方法就可以了，使server_id+0之后再排序，问题解决了。<br/>
select server_id from cardserver where game_id = 1 order by server_id+0 desc limit 10;<br/>
+-----------+<br/>
| server_id |<br/>
+-----------+<br/>
| 10        | <br/>
| 8         | <br/>
| 7         | <br/>
| 6         | <br/>
| 5         | <br/>
| 4         | <br/>
| 3         | <br/>
| 2         | <br/>
| 1         | <br/>
+-----------+</p>

<p>使用MySQL函数CAST/CONVERT：<br/>
mysql为我们提供了两个类型转换函数：CAST和CONVERT，现成的东西我们怎能放过？<br/>
CAST() 和CONVERT() 函数可用来获取一个类型的值，并产生另一个类型的值。<br/>
这个类型 可以是以下值其中的 一个：<br/>
BINARY[(N)]<br/>
CHAR[(N)]<br/>
DATE<br/>
DATETIME<br/>
DECIMAL<br/>
SIGNED [INTEGER]<br/>
TIME<br/>
UNSIGNED [INTEGER]<br/>
所以我们也可以用CAST解决问题：<br/>
select server_id from cardserver where game_id = 1 order by CAST(server_id as SIGNED) desc limit 10;<br/>
也可以使用CONVERT来搞定此问题：<br/>
select server_id from cardserver where game_id = 1 order by CONVERT(server_id,SIGNED) desc limit 10;</p>


			
			
		</div>

	</article>
 
	<article class="post" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
		<div class="meta">
			<div class="date">
				<time datetime="2010-02-06T10:57:46+08:00" itemprop="datePublished">2010/02/06</time>
			</div>
			<div class="tags">posted in 
			
			    <a class='category' href='server.html'>服务端</a>&nbsp;
			 
			</div>
		</div>
		<h1 class="title" itemprop="name"><a href="15809578667154.html" itemprop="url">
		全文检索</a></h1>
		<div class="entry-content" itemprop="articleBody">
			
			<p>date: 2010-12-10 01:11</p>

<p>全文检索是指计算机索引程序通过扫描文章中的每一个词，对每一个词建立一个索引，指明该词在文章中出现的次数和位置，当用户查询时，检索程序就根据事先建立的索引进行查找，并将查找的结果反馈给用户的检索方式。这个过程类似于通过字典中的检索字表查字的过程。</p>


			
			
		</div>

	</article>
  

</div>
<nav id="pagenavi">
	 
	
	<div class="center"><a href="archives.html">Blog Archives</a></div>

</nav>

</div>



        </div>
			<footer id="footer" class="inner">Copyright &copy; 2014
Powered by <a target="_blank" href="http://www.mweb.im">MWeb</a> &nbsp;&nbsp; 
Theme by <a href="http://shashankmehta.in/archive/2012/greyshade.html">Shashank Mehta</a>
      </footer>
		</div>
	</div>



  














<style type="text/css">
figure{margin: 1em 0;padding: 0;}
  figcaption{text-align:center;}

/* PrismJS 1.14.0
https://prismjs.com/download.html#themes=prism-coy&languages=markup+css+clike+javascript */
/**
 * prism.js Coy theme for JavaScript, CoffeeScript, CSS and HTML
 * Based on https://github.com/tshedor/workshop-wp-theme (Example: http://workshop.kansan.com/category/sessions/basics or http://workshop.timshedor.com/category/sessions/basics);
 * @author Tim  Shedor
 */

code[class*="language-"],
pre[class*="language-"] {
  color: black;
  background: none;
  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.5;

  -moz-tab-size: 4;
  -o-tab-size: 4;
  tab-size: 4;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

/* Code blocks */
pre[class*="language-"] {
  position: relative;
  margin: .5em 0;
  overflow: visible;
  padding: 0;
}
pre[class*="language-"]>code {
  position: relative;
  border-left: 10px solid #358ccb;
  box-shadow: -1px 0px 0px 0px #358ccb, 0px 0px 0px 1px #dfdfdf;
  background-color: #fdfdfd;
  background-image: linear-gradient(transparent 50%, rgba(69, 142, 209, 0.04) 50%);
  background-size: 3em 3em;
  background-origin: content-box;
  background-attachment: local;
}

code[class*="language"] {
  max-height: inherit;
  height: inherit;
  padding: 0 1em;
  display: block;
  overflow: auto;
}

/* Margin bottom to accomodate shadow */
:not(pre) > code[class*="language-"],
pre[class*="language-"] {
  background-color: #fdfdfd;
  -webkit-box-sizing: border-box;
  -moz-box-sizing: border-box;
  box-sizing: border-box;
  margin-bottom: 1em;
}

/* Inline code */
:not(pre) > code[class*="language-"] {
  position: relative;
  padding: .2em;
  border-radius: 0.3em;
  color: #c92c2c;
  border: 1px solid rgba(0, 0, 0, 0.1);
  display: inline;
  white-space: normal;
}

pre[class*="language-"]:before,
pre[class*="language-"]:after {
  content: '';
  z-index: -2;
  display: block;
  position: absolute;
  bottom: 0.75em;
  left: 0.18em;
  width: 40%;
  height: 20%;
  max-height: 13em;
  box-shadow: 0px 13px 8px #979797;
  -webkit-transform: rotate(-2deg);
  -moz-transform: rotate(-2deg);
  -ms-transform: rotate(-2deg);
  -o-transform: rotate(-2deg);
  transform: rotate(-2deg);
}

:not(pre) > code[class*="language-"]:after,
pre[class*="language-"]:after {
  right: 0.75em;
  left: auto;
  -webkit-transform: rotate(2deg);
  -moz-transform: rotate(2deg);
  -ms-transform: rotate(2deg);
  -o-transform: rotate(2deg);
  transform: rotate(2deg);
}

.token.comment,
.token.block-comment,
.token.prolog,
.token.doctype,
.token.cdata {
  color: #7D8B99;
}

.token.punctuation {
  color: #5F6364;
}

.token.property,
.token.tag,
.token.boolean,
.token.number,
.token.function-name,
.token.constant,
.token.symbol,
.token.deleted {
  color: #c92c2c;
}

.token.selector,
.token.attr-name,
.token.string,
.token.char,
.token.function,
.token.builtin,
.token.inserted {
  color: #2f9c0a;
}

.token.operator,
.token.entity,
.token.url,
.token.variable {
  color: #a67f59;
  background: rgba(255, 255, 255, 0.5);
}

.token.atrule,
.token.attr-value,
.token.keyword,
.token.class-name {
  color: #1990b8;
}

.token.regex,
.token.important {
  color: #e90;
}

.language-css .token.string,
.style .token.string {
  color: #a67f59;
  background: rgba(255, 255, 255, 0.5);
}

.token.important {
  font-weight: normal;
}

.token.bold {
  font-weight: bold;
}
.token.italic {
  font-style: italic;
}

.token.entity {
  cursor: help;
}

.namespace {
  opacity: .7;
}

@media screen and (max-width: 767px) {
  pre[class*="language-"]:before,
  pre[class*="language-"]:after {
    bottom: 14px;
    box-shadow: none;
  }

}

/* Plugin styles */
.token.tab:not(:empty):before,
.token.cr:before,
.token.lf:before {
  color: #e0d7d1;
}

/* Plugin styles: Line Numbers */
pre[class*="language-"].line-numbers.line-numbers {
  padding-left: 0;
}

pre[class*="language-"].line-numbers.line-numbers code {
  padding-left: 3.8em;
}

pre[class*="language-"].line-numbers.line-numbers .line-numbers-rows {
  left: 0;
}

/* Plugin styles: Line Highlight */
pre[class*="language-"][data-line] {
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 0;
}
pre[data-line] code {
  position: relative;
  padding-left: 4em;
}
pre .line-highlight {
  margin-top: 0;
}

pre[class*="language-"].line-numbers {
    position: relative;
    padding-left: 3.8em;
    counter-reset: linenumber;
}

pre[class*="language-"].line-numbers > code {
    position: relative;
    white-space: inherit;
}

.line-numbers .line-numbers-rows {
    position: absolute;
    pointer-events: none;
    top: 0;
    font-size: 100%;
    left: -3.8em;
    width: 3em; /* works for line-numbers below 1000 lines */
    letter-spacing: -1px;
    border-right: 1px solid #999;

    -webkit-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
    user-select: none;

}

    .line-numbers-rows > span {
        pointer-events: none;
        display: block;
        counter-increment: linenumber;
    }

        .line-numbers-rows > span:before {
            content: counter(linenumber);
            color: #999;
            display: block;
            padding-right: 0.8em;
            text-align: right;
        }

</style>
  
    


</body>
</html>