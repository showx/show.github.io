

<!DOCTYPE html>
<html lang="zh">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>
      
    --- - shengsheng的博客
    
    </title>
    
    
    
    <link href="atom.xml" rel="alternate" title="shengsheng的博客" type="application/atom+xml">
    <link rel="stylesheet" href="asset/style.css">
    
</head>
  <body>




        <div id="wrapper">
            <header class="site-header">
                <div class="container">
                    <div class="site-title-wrapper">
                          <a class="button-square" href="index.html">
<svg class="svg-inline--fa fa-home fa-w-18" aria-hidden="true" focusable="false" data-prefix="fas" data-icon="home" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512" data-fa-i2svg=""><path fill="currentColor" d="M280.37 148.26L96 300.11V464a16 16 0 0 0 16 16l112.06-.29a16 16 0 0 0 15.92-16V368a16 16 0 0 1 16-16h64a16 16 0 0 1 16 16v95.64a16 16 0 0 0 16 16.05L464 480a16 16 0 0 0 16-16V300L295.67 148.26a12.19 12.19 0 0 0-15.3 0zM571.6 251.47L488 182.56V44.05a12 12 0 0 0-12-12h-56a12 12 0 0 0-12 12v72.61L318.47 43a48 48 0 0 0-61 0L4.34 251.47a12 12 0 0 0-1.6 16.9l25.5 31A12 12 0 0 0 45.15 301l235.22-193.74a12.19 12.19 0 0 1 15.3 0L530.9 301a12 12 0 0 0 16.9-1.6l25.5-31a12 12 0 0 0-1.7-16.93z"></path></svg>
                            </a>
                        
                         
                        
                        
                        
                        <a class="button-square" href="https://github.com/showx" target="_blank" title="github">
                               <svg class="svg-inline--fa fa-github fa-w-16" aria-hidden="true" focusable="false" data-prefix="fab" data-icon="github" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512" data-fa-i2svg=""><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg><!-- <i class="fab fa-github fa-lg"></i> -->
                          </a>
                        
                        
                      
                      <a class="button-square" href="atom.xml" target="_blank" title="RSS">
                              <svg class="svg-inline--fa fa-rss fa-w-14" aria-hidden="true" focusable="false" data-prefix="fas" data-icon="rss" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" data-fa-i2svg=""><path fill="currentColor" d="M128.081 415.959c0 35.369-28.672 64.041-64.041 64.041S0 451.328 0 415.959s28.672-64.041 64.041-64.041 64.04 28.673 64.04 64.041zm175.66 47.25c-8.354-154.6-132.185-278.587-286.95-286.95C7.656 175.765 0 183.105 0 192.253v48.069c0 8.415 6.49 15.472 14.887 16.018 111.832 7.284 201.473 96.702 208.772 208.772.547 8.397 7.604 14.887 16.018 14.887h48.069c9.149.001 16.489-7.655 15.995-16.79zm144.249.288C439.596 229.677 251.465 40.445 16.503 32.01 7.473 31.686 0 38.981 0 48.016v48.068c0 8.625 6.835 15.645 15.453 15.999 191.179 7.839 344.627 161.316 352.465 352.465.353 8.618 7.373 15.453 15.999 15.453h48.068c9.034-.001 16.329-7.474 16.005-16.504z"></path></svg><!-- <i class="fas fa-rss fa-lg"></i> -->
                      </a>

              
                       
                         
                        
                    </div>

                    <ul class="site-nav">
                        
                    </ul>
                </div>
            </header>

            <div id="container">

 
<div class="container">
  <article class="post-container">
    <header class="post-header">
        <h1 class="post-title">---</h1>
        <p class="post-date">
                <span>Posted <time datetime="2020/02/06" itemprop="datePublished">2020/02/06</time></span>
            </p>
    </header>

    <div class="post-content clearfix">
<p>layout: post<br/>
title: linux实用命令<br/>
date: 2015-08-03 14:35<br/>
author: admin<br/>
comments: true</p>

<h2 id="toc_0">categories: []</h2>

<p>硬件/系统基本操作<br/>
dmesg 系统信息(包括启动时相关的信息和警告等)</p>

<p>//查看系统所有硬件信息<br/>
lshw &gt; sys.txt</p>

<p>检查服务状态：<br/>
service --status-all<br/>
service --status-all | less<br/>
service httpd status</p>

<p>列出所有服务启动级别：<br/>
chkconfig --list<br/>
(ubunut使用 sysv-rc-conf 需安装)</p>

<p>列出服务和他们对应的端口：<br/>
netstat -tulpn</p>

<p>查看版本<br/>
cat /etc/redhat-release<br/>
cat /etc/issue</p>

<p>设置服务器语言<br/>
vi /etc/profile<br/>
add:<br/>
export LC_ALL=&quot;zh_CN.UTF-8&quot;   (或zh_CN.GB18030)</p>

<p>显示硬盘状态(普通raid0/1)<br/>
//最后一个参数为 0-n(raid组)<br/>
/usr/sbin/mpt-status --autoload  -s -i 2 -i 0<br/>
//通用<br/>
/usr/sbin/mpt-status --autoload  -s<br/>
megacli -LDInfo -Lall -aALL 查raid级别<br/>
megacli -AdpAllInfo -aALL 查raid卡信息<br/>
megacli -PDList -aALL 查看硬盘信息<br/>
megacli -LDInfo -LALL -aAll 显示所有逻辑磁盘组信息</p>

<p>//ubuntu10.04对Dell PERC 6/i Adapter阵列卡监控问题<br/>
<a href="http://hwraid.le-vert.net/wiki/DebianPackages">http://hwraid.le-vert.net/wiki/DebianPackages</a><br/>
echo -e &quot;\ndeb <a href="http://hwraid.le-vert.net/debian">http://hwraid.le-vert.net/debian</a> squeeze main&quot; &gt;&gt; /etc/apt/sources.list<br/>
并更新, 安装<br/>
apt-get install megaclisas-status<br/>
运行 megaclisas-status 即可获得raid状态</p>

<p>//用户与权限<br/>
创建用户<br/>
useradd -d /www -g www-data -s /bin/sh www-data</p>

<h1 id="toc_1">useradd -d /www/webhome -g www-data -s /bin/bash wwwftp</h1>

<p>查看所有用户<br/>
vi /etc/passwd<br/>
修改主目录<br/>
usermod -d /usr/newfolder 用户名<br/>
(修改用户相关的其它参数[非密码]也使用这命令)<br/>
chgrp gname file 改变文件组<br/>
chown uname file 改变文件拥有人</p>

<p>创建文件链接<br/>
ln -s 文件名 链接文件名(可以为具体文件名, 也可以为目录名)<br/>
如果是建立目录的硬连接则用 -d</p>

<p>禁用shell，先 /etc/shells 增加 /bin/false 然后指定这个shell</p>

<p>检测网络缓慢或不通的原因(路由追踪)<br/>
tracert ip或域名</p>

<p>系统性能查看(sysstat 包)</p>

<p>cat /proc/meminfo</p>

<ol>
<li><p>vmstat   //查看综合情况，包括CPU、Memory、I/O</p></li>
<li><p>iostat -x 1   //看看是谁发出的I/O请求（这里参考以前用bonie在干净系统测试的硬件能力）<br/>
iostat -d 2 5</p></li>
<li><p>top   //查看系统最活跃的应用程序</p></li>
<li><p>strace -p xxx   //跟踪这个进程都读了那些文件</p></li>
<li><p>dmesg 查看系统启动日志</p></li>
</ol>

<p>sar -n DEV -u 1 10<br/>
看看当前网络流量</p>

<p>lftp多线程下载<br/>
lftp -c &quot;pget -n 50 http://xxx&quot;</p>

<p>网络状态<br/>
netstat -n | awk &#39;/<sup>tcp/</sup> {++S[$NF]} END {for(a in S) print a, S[a]}&#39;;<br/>
netstat -nat | wc -l<br/>
netstat -anp | wc -l</p>

<p>php-cgi连接状态<br/>
netstat -anp | grep php-cgi | wc -l<br/>
netstat -anp | grep :9000 | wc -l</p>

<p>php-cgi总线程<br/>
ps aux | grep php-cgi | wc -l</p>

<p>//捕获所有连接源<br/>
netstat -an -t tcp | grep &quot;:80&quot; | grep TIME_WAIT | awk &#39;{printf &quot;%s %s\n&quot;,\(5,\)6}&#39; | sort &gt;&gt; /home/ylmfbbs/wait.txt</p>

<p>//使用虚拟用户的vsftpd密码生成<br/>
db_load -T -t hash -f user_pwds.txt /etc/vsftpd/vsftpd_login.db</p>

<p>//普通用户不启用shell无法登录<br/>
vi /etc/shells 增加 /bin/false</p>

<p>//安装服务自启动(必须init.d有这文件)<br/>
update-rc.d nginx defaults<br/>
update-rc.d vsftpd defaults<br/>
update-rc.d mysql defaults</p>

<p>//移除(移除自启动链接, 但不会删除 init.d的文件)<br/>
update-rc.d -f lighttpd remove</p>

<p>//查看链接数<br/>
netstat -n | awk &#39;/<sup>tcp/</sup> {++S[$NF]} END {for(a in S) print a, S[a]}&#39;</p>

<p>mysql默认安装<br/>
apt-get install mysql-server mysql-client</p>

<p>shutdown -h now  真正关机<br/>
shutdown -r now 重启 ( reboot )</p>

<p>Ubuntu下无法使用root登录Mysql的解决办法 </p>

<p>mysqldump -u 115search -h 192.168.5.205 -p 115_search &gt; /home/ylmf/115_search.sql</p>

<p>2011-01-29 10:13:08|  分类： Hack |  标签：mysql  root  密码  ubuntu  debian   |字号 订阅<br/>
解决方法如下：<br/>
打开/etc/mysql/debian.cnf文件，记录下文件中［client］节提供的用户名和密码:</p>

<p>mysql -u debian-sys-maint -p<br/>
Enter password:&lt;输入［client］节的密码&gt;<br/>
mysql&gt;use mysql;<br/>
mysql&gt;UPDATE user SET Password= PASSWORD(&#39;密码&#39;)  where user=&#39;root&#39;;<br/>
mysql&gt;quit</p>

<p>update user set Host = &#39;192.168.5.%&#39; where Host &lt;&gt; &#39;localhost&#39; ;</p>

<p>select host, user from user;</p>

<p>flush privileges;</p>

<p>CREATE USER &#39;115tool&#39;@&#39;192.168.5.%&#39; IDENTIFIED BY &#39;5H9BH7xnBJf4fH4Y&#39;;</p>

<p>GRANT USAGE ON * . * TO &#39;115tool&#39;@&#39;192.168.5.%&#39; IDENTIFIED BY &#39;5H9BH7xnBJf4fH4Y&#39; WITH MAX_QUERIES_PER_HOUR 0 MAX_CONNECTIONS_PER_HOUR 0 MAX_UPDATES_PER_HOUR 0 MAX_USER_CONNECTIONS 0 ;</p>

<p>GRANT ALL PRIVILEGES ON <code>115\_tool2</code> . * TO &#39;115tool&#39;@&#39;192.168.5.%&#39; WITH GRANT OPTION ;</p>

<p>GRANT ALL PRIVILEGES ON <code>dzbbs_utf8</code> . * TO &#39;dzbbs&#39;@&#39;192.168.5.%&#39; WITH GRANT OPTION ;</p>

<p>//全权限用户<br/>
CREATE USER &#39;root&#39;@&#39;119.145.100.138&#39; IDENTIFIED BY &#39;pwd&#39;;<br/>
GRANT ALL PRIVILEGES ON * . * TO &#39;root&#39;@&#39;119.145.100.138&#39; IDENTIFIED BY &#39;pwd&#39; WITH GRANT OPTION MAX_QUERIES_PER_HOUR 0 MAX_CONNECTIONS_PER_HOUR 0 MAX_UPDATES_PER_HOUR 0 MAX_USER_CONNECTIONS 0 ;</p>

<p>//查看mysql进程<br/>
show processlist;<br/>
显示运行状态<br/>
SHOW STATUS;<br/>
显示变量<br/>
Show Variables;<br/>
显示引擎<br/>
show engines;</p>

<p>//压缩/解压<br/>
tar cvf filename.tar source<br/>
tar xvf source_filename<br/>
tar zcvf filename.tar.gz source<br/>
tar zxvf source_filename</p>

<p>//基本开发环境<br/>
apt-get install build-essential</p>

<p>//防火墙设置<br/>
增加项目<br/>
iptables -A INPUT -s 0.0.0.0/0 -p tcp -m tcp --dport 873 -j ACCEPT</p>

<p>iptables -A INPUT -s 0.0.0.0/0 -p tcp -m tcp --dport 3306 -j ACCEPT</p>

<p>//保存<br/>
iptables-save &gt; /etc/iptables.up.rules</p>

<p>//加载<br/>
iptables-restore &lt; /etc/iptables.up.rules</p>

<p>SVN<br/>
//创建<br/>
svnadmin create web/union.demo.116.com<br/>
同步: 修改hooks文件<br/>
权限: 修改passwd文件</p>

<p>取出<br/>
svn co svn://xxx --username xxx --password xxx  target_dir</p>

<p>更新<br/>
svn update [-r] [m] path</p>

<p>删除<br/>
svn delete path -m &quot;delete xxx&quot;</p>

<p>/usr/bin/svnserve -d -r /www/svn/</p>

<p>解决冲突<br/>
svn resolved</p>

<p>//10.04 crond<br/>
crontab -e 生成一个文件(也可以直接编辑)<br/>
crontab -u root /var/spool/cron/crontabs/root<br/>
vi /var/spool/cron/crontabs/root<br/>
增加任务后<br/>
service cron restart</p>

<p>crontab文件格式:</p>

<ul>
<li>* * * * 命令<br/>
分 时 日 月 星期0～6(0表示星期天)  命令(允许有空格如 ls &gt;&gt; t.txt)</li>
</ul>

<p>其中可数字表示格式有:</p>

<p>*/n 每间隔多少, 其中 */1 == * 本身<br/>
n1,n2,n3 指定时间是  n1 n2 n3<br/>
n1-n2    指定 n1 - n2 这个时间区间</p>

<p>这些格式可以混合使用, 如:<br/>
10-30/5 * * * * 表示 10-30分钟期间每隔5分钟</p>

<p>//tool.114la.com fast-cgi</p>

<p>/usr/local/spawn-fcgi/bin/spawn-fcgi -a 127.0.0.1 -p 9000 -C 4 -F 50 -u www-data -f /usr/bin/php-cgi</p>

<p>//格式化磁盘与挂载<br/>
查看分区<br/>
fdisk -l<br/>
fdisk /具体盘(对具体盘进行分区)<br/>
参数: p 查看已分区  n 创建新分区 d 删除分区</p>

<p>格式化:<br/>
mkfs -t ext3/4  /已分好的区</p>

<p>挂载:<br/>
mount -t ext4 /已分好的区 /挂载目录</p>

<p>自动加载:<br/>
/etc/fstab<br/>
UUID=abc22332-8e95-488d-a0a1-fa25e157b9ce   /挂载目录    ext4    defaults    0   2<br/>
UUID方式表示指定磁盘的第一个分区</p>

<p>指定挂载方式:<br/>
/已分好的区 /挂载目录 ext4 defaults 0 0</p>

<p>//查看某文件夹子目录文件大小<br/>
du -sm * | sort -n</p>

<p>//安装innodb<br/>
edit /etc/apparmor.d/usr.sbin.mysqld<br/>
add:<br/>
/usr/lib/mysql/plugin/ r,<br/>
/usr/lib/mysql/plugin/* mr,<br/>
reload apparmor and restart the MySQL service.</p>

<p>show variables like &#39;plugin_dir&#39;;<br/>
INSTALL PLUGIN InnoDB SONAME &#39;ha_innodb_plugin.so.0.0.0&#39;;</p>

<p>//时间设置<br/>
直接修改时间<br/>
date --set=&quot;07/17/13 11:31:00&quot;<br/>
hwclock --systohc<br/>
//设置时间同步<br/>
rm /etc/localtime<br/>
ln -s /usr/share/zoneinfo/Asia/Shanghai /etc/localtime<br/>
apt-get install ntp ntpupdate<br/>
/etc/init.d/ntp start</p>

<p>apt-get 查找包<br/>
apt-cache search 包名</p>

<p>//web服务器常用lib<br/>
apt-get install build-essential libxml2 libxml2-dev libevent-1.4-2 libevent-dev libcurl4-openssl-dev libgd2-xpm libgd2-xpm-dev libjpeg62 libjpeg62-dev libpng12-0 libpng12-dev  libgif4 libgift-dev libfreetype6 libfreetype6-dev  zlib1g zlib1g-dev libbz2-1.0 libbz2-dev libtool libmcrypt4 libmcrypt-dev libmysqlclient-dev libpcre3 libpcre3-dev autoconf</p>

<p>//12.04<br/>
apt-get install build-essential libxml2 libxml2-dev libevent-1.4-2 libevent-dev libcurl4-openssl-dev libgd2-xpm libjpeg62 libjpeg62-dev libpng12-0 libpng12-dev  libgif4 libfreetype6 libfreetype6-dev  zlib1g zlib1g-dev libbz2-1.0 libbz2-dev libtool libmcrypt4 libmcrypt-dev libmysqlclient-dev libpcre3 libpcre3-dev autoconf</p>

<ul>
<li>14.04 没有 libgd2-xpm</li>
<li>8.04 用 libmysqlclient15-dev</li>
</ul>

<p>//nginx编译</p>

<p>apt-get install libpcre3 libpcre3-dev zlib1g-dev</p>

<p>mkdir /var/tmp/nginx</p>

<p>./configure --prefix=/usr --sbin-path=/usr/sbin --conf-path=/etc/nginx/nginx.conf --pid-path=/var/run/nginx.pid --lock-path=/var/lock/nginx.lock --error-log-path=/var/log/nginx/main_error.log --http-log-path=/var/log/nginx/ --http-client-body-temp-path=/var/tmp/nginx/client_body/ --http-proxy-temp-path=/var/tmp/nginx/proxy/ --http-fastcgi-temp-path=/var/tmp/nginx/fcgi/ --with-http_stub_status_module</p>

<p>--add-module=../ngx_cache_purge-1.2</p>

<p>//假如找不到libpcre<br/>
ln -s libpcre.so.3.12.1 libpcre.so.0</p>

<p>//php5.2编译<br/>
patch -d php-5.2.17 -p1 &lt; php-5.2.13-fpm-0.5.14.diff<br/>
(如果没有打fpm补丁的包才用这个， 不装fpm可不必理会--enable-fpm后面相关参数)</p>

<p>./configure --prefix=/usr --with-config-file-path=/etc/php  --with-mysql --with-mysqli --with-pdo-mysql --with-gd --with-freetype-dir=/usr --with-jpeg-dir=/usr --with-png-dir=/usr --with-libxml-dir=/usr --with-zlib --enable-exif --enable-xml --enable-bcmath --enable-shmop --enable-sysvsem --enable-inline-optimization --with-bz2 --with-curl --with-curlwrappers --with-mcrypt --with-openssl --with-gettext --enable-filter --enable-simplexml --enable-mbstring --enable-soap --enable-discard-path --enable-fastcgi --enable-dba --enable-force-cgi-redirect --enable-ftp --enable-fpm --with-fpm-conf=/etc/php/php-fpm.conf --with-fpm-log=/var/log/php-fpm.log --with-fpm-pid=/var/run/php-fpm.pid</p>

<p>64位系统需加上：--with-libdir=lib/x86_64-linux-gnu  (php5.2x ubuntu)</p>

<p>//php5.3编译</p>

<p>./configure --prefix=/usr --with-config-file-path=/etc/php  --with-mysql --with-mysqli --with-pdo-mysql --with-gd --with-freetype-dir=/usr --with-jpeg-dir=/usr --with-png-dir=/usr --with-libxml-dir=/usr --with-zlib --enable-exif --enable-xml --enable-bcmath --enable-shmop --enable-sysvsem --enable-inline-optimization --with-bz2 --with-curl --with-curlwrappers --with-mcrypt --with-openssl --with-gettext --enable-filter --enable-simplexml --enable-mbstring --enable-soap --enable-dba --enable-ftp --enable-fpm</p>

<p>支持mysqlnd版本注意这个选项（使用mysqlnd本地化类，提升数据库处理性能）:<br/>
--enable-mysqlnd  --with-mysql=mysqlnd  --with-mysqli=mysqlnd  --with-pdo-mysql=mysqlnd</p>

<p>./configure --prefix=/usr --with-config-file-path=/etc/php  --enable-mysqlnd  --with-mysql=mysqlnd --with-mysqli=mysqlnd  --with-pdo-mysql=mysqlnd --with-gd --with-freetype-dir=/usr --with-jpeg-dir=/usr --with-png-dir=/usr --with-libxml-dir=/usr --with-zlib --enable-exif --enable-xml --enable-bcmath --enable-shmop --enable-sysvsem --enable-inline-optimization --with-bz2 --with-curl --with-curlwrappers --with-mcrypt --with-openssl --with-gettext --enable-filter --enable-simplexml --enable-mbstring --enable-soap --enable-dba --enable-ftp --enable-fpm</p>

<p>php-fpm配置默认在：<br/>
/usr/etc<br/>
兼容性选项<br/>
--enable-mbregex(ereg支持)<br/>
--enable-magic-quotes (支持magic-quotes)</p>

<p>php5可加上<br/>
--enable-opcache<br/>
参数</p>

<p>//编译扩展<br/>
/usr/bin/phpize</p>

<p>//茂名联通网关：<br/>
route add -net 125.211.218.82/32 dev eth0:0<br/>
route add -net 125.211.218.82/32 gw 58.253.70.1</p>

<p>//删除后台挂起的线程<br/>
kill -s 9 进程id</p>

<p>//NFS安装<br/>
apt-get install nfs-kernel-server nfs-common portmap<br/>
apt-get install nfs-common(客户机必须安装这个)<br/>
dpkg-reconfigure portmap (选择&#39;no&#39;)</p>

<h1 id="toc_2">注册服务自启动</h1>

<p>sysv-rc-conf portmap on<br/>
sudo sysv-rc-conf nfs-kernel-server on</p>

<h1 id="toc_3">设置共享目录和参数</h1>

<p>vi /etc/exports<br/>
exportfs -rv(重新加载配置)<br/>
exportfs -au(卸载)<br/>
//防火墙设置<br/>
1、对访问host的限制<br/>
/etc/hosts.deny</p>

<h3 id="toc_4">NFS DAEMONS</h3>

<p>portmap:ALL<br/>
lockd:ALL<br/>
mountd:ALL<br/>
rquotad:ALL<br/>
statd:ALL<br/>
/etc/hosts.allow</p>

<h3 id="toc_5">NFS DAEMONS</h3>

<p>portmap: 192.168.5.<br/>
lockd: 192.168.5.<br/>
rquotad: 192.168.5.<br/>
mountd: 192.168.5.<br/>
statd: 192.168.5.</p>

<p>portmap restart</p>

<p>防火墙默认需要开放端口：</p>

<h1 id="toc_6">启动服务</h1>

<p>/etc/init.d/portmap start<br/>
/etc/init.d/nfs-kernel-server restart</p>

<p>mount -t nfs 192.168.5.209:/var/www/bbs/bbs.ylmf.net /www/bbs.ylmf.net<br/>
mount -t nfs 192.168.5.209:/www/pw /www/pw</p>

<p>//iptables启动关闭<br/>
//启动iptables<br/>
modprobe ip_tables</p>

<p>//关闭iptables(关闭命令要比启动复杂)<br/>
iptalbes -F<br/>
iptables -X<br/>
iptables -Z<br/>
iptables -P INPUT ACCEPUT<br/>
iptables -P OUTPUT ACCEPUT<br/>
iptables -P FORWARD ACCEPUT<br/>
modprobe -r ip_tables</p>

<p>VI技巧</p>

<p>替换行首为特定内容<br/>
:g/<sup>/s//替换后的内容</sup> /g<br/>
如: :g/<sup>/s//rm</sup> -r /g</p>

<p>普通替换<br/>
:%s/源内容/替换后的内容/g</p>

<p>g 放在命令末尾，表示对搜索字符串的每次出现进行替换<br/>
不加 g，表示只对搜索字符串的首次出现进行替换<br/>
g 放在命令开头，表示对正文中所有包含搜索字符串的行进行替换操作</p>

<p>//时间修正<br/>
cp /usr/share/zoneinfo/Asia/Shanghai /etc/localtime</p>

<p>ntpdate stdtime.gov.hk | ntp.ubuntu.com | time.nist.gov</p>

<p>安装 ntp 服务 修改 /etc/ntp.conf 加入<br/>
server stdtime.gov.hk<br/>
server ntp.ubuntu.com<br/>
server time.nist.gov</p>

<p>//查找文件进行删除<br/>
find ./ -type d ! -name . | xargs rm -r<br/>
find ./ -name . | xargs rm<br/>
例: 删除WEB上面含有的SVN信息<br/>
find -type d -name &quot;.svn&quot; | xargs rm -rf</p>

<p>//处理apt-get安装出错<br/>
mv /var/lib/dpkg/info /var/lib/dpkg/info_old<br/>
mkdir /var/lib/dpkg/info<br/>
apt-get update<br/>
apt-get -f install<br/>
mv /var/lib/dpkg/info/* /var/lib/dpkg/info_old<br/>
rm -rf /var/lib/dpkg/info<br/>
mv /var/lib/dpkg/info_old /var/lib/dpkg/info</p>

<p>压力测试软件<br/>
webbench -c 25000 -t 300 <a href="http://www.test.com/index.php">http://www.test.com/index.php</a></p>

<p>wget <a href="http://server-admin.114la.com/tmp/maxfile.sh">http://server-admin.114la.com/tmp/maxfile.sh</a></p>

<h1 id="toc_7">提高并发支持数</h1>

<p>ulimit -SHn 65535</p>

<p>蓝汛机房路由设置<br/>
在<br/>
/etc/iproute2/rt_tables<br/>
增加<br/>
252 tel<br/>
251 cnc<br/>
执行(x表示实际要处理的IP)</p>

<h1 id="toc_8">! /bin/bash</h1>

<p>TEL_IP=121.14.148.x<br/>
CNC_IP=112.90.217.x</p>

<p>ip route flush table tel<br/>
ip route add default via 121.14.148.1 dev eth0 src \(TEL_IP table tel<br/>
ip rule add from \)TEL_IP table tel</p>

<p>ip route flush table cnc<br/>
ip route add default via 112.90.217.254 dev eth1 src \(CNC_IP table cnc<br/>
ip rule add from \)CNC_IP table cnc</p>

<p>统计某文件夹下文件的个数<br/>
ls -l |grep &quot;<sup>-&quot;|wc</sup> -l</p>

<p>统计某文件夹下目录的个数<br/>
ls -l |grep &quot;<sup>d&quot;|wc</sup> -l</p>

<p>统计文件夹下文件的个数，包括子文件夹里的<br/>
ls -lR |grep &quot;<sup>-&quot;|wc</sup> -l</p>

<h1 id="toc_9">把centos命令行提示设置成和ubuntu一致</h1>

<p>vi ~/.bashrc<br/>
在结尾加入<br/>
PS1=&quot;\u@\h:\w$&quot;</p>

<h1 id="toc_10">列出进程包含进程详细信息</h1>

<p>ps -ef</p>

<h1 id="toc_11">线程调试跟踪</h1>

<p>strace -p id</p>

<h1 id="toc_12">定位lib文件位置</h1>

<p>locate name</p>

<h1 id="toc_13">列出全部uuid</h1>

<p>blkid</p>

<h1 id="toc_14">网卡实时流量监控</h1>

<p>iftop -i eth0</p>

<h1 id="toc_15">查看所有进程的文件打开数</h1>

<p>lsof | wc -l</p>

<h1 id="toc_16">查看某个进程打开的文件数</h1>

<p>lsof -p pid |wc -l</p>

<p>重新配置服务器时区<br/>
dpkg-reconfigure tzdata</p>

    </div>
    <footer class="post-footer clearfix">
      
           
      
        
    </footer>
     <div class="comments-wrap">
        <div class="share-comments">
          

          

          
        </div>
      </div><!-- end comments wrap -->
  </article>
 </div><!-- end-->



    <footer class="footer">
            <div class="container">
                <div class="site-footer-wrapper">
                        <a class="button-square" href="index.html">
<svg class="svg-inline--fa fa-home fa-w-18" aria-hidden="true" focusable="false" data-prefix="fas" data-icon="home" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512" data-fa-i2svg=""><path fill="currentColor" d="M280.37 148.26L96 300.11V464a16 16 0 0 0 16 16l112.06-.29a16 16 0 0 0 15.92-16V368a16 16 0 0 1 16-16h64a16 16 0 0 1 16 16v95.64a16 16 0 0 0 16 16.05L464 480a16 16 0 0 0 16-16V300L295.67 148.26a12.19 12.19 0 0 0-15.3 0zM571.6 251.47L488 182.56V44.05a12 12 0 0 0-12-12h-56a12 12 0 0 0-12 12v72.61L318.47 43a48 48 0 0 0-61 0L4.34 251.47a12 12 0 0 0-1.6 16.9l25.5 31A12 12 0 0 0 45.15 301l235.22-193.74a12.19 12.19 0 0 1 15.3 0L530.9 301a12 12 0 0 0 16.9-1.6l25.5-31a12 12 0 0 0-1.7-16.93z"></path></svg>
                            </a>
                        
                         
                        
                        
                        
                        <a class="button-square" href="https://github.com/showx" target="_blank" title="github">
                               <svg class="svg-inline--fa fa-github fa-w-16" aria-hidden="true" focusable="false" data-prefix="fab" data-icon="github" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512" data-fa-i2svg=""><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg><!-- <i class="fab fa-github fa-lg"></i> -->
                          </a>
                        
                        
                      
                      <a class="button-square" href="atom.xml" target="_blank" title="RSS">
                              <svg class="svg-inline--fa fa-rss fa-w-14" aria-hidden="true" focusable="false" data-prefix="fas" data-icon="rss" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" data-fa-i2svg=""><path fill="currentColor" d="M128.081 415.959c0 35.369-28.672 64.041-64.041 64.041S0 451.328 0 415.959s28.672-64.041 64.041-64.041 64.04 28.673 64.04 64.041zm175.66 47.25c-8.354-154.6-132.185-278.587-286.95-286.95C7.656 175.765 0 183.105 0 192.253v48.069c0 8.415 6.49 15.472 14.887 16.018 111.832 7.284 201.473 96.702 208.772 208.772.547 8.397 7.604 14.887 16.018 14.887h48.069c9.149.001 16.489-7.655 15.995-16.79zm144.249.288C439.596 229.677 251.465 40.445 16.503 32.01 7.473 31.686 0 38.981 0 48.016v48.068c0 8.625 6.835 15.645 15.453 15.999 191.179 7.839 344.627 161.316 352.465 352.465.353 8.618 7.373 15.453 15.999 15.453h48.068c9.034-.001 16.329-7.474 16.005-16.504z"></path></svg><!-- <i class="fas fa-rss fa-lg"></i> -->
                      </a>

              
                       
                                                
                </div>
                <div class="site-menu-wrapper">
                  &nbsp;<span>|</span>&nbsp;
                  
                    <a target="self" class="" href="index.html">Home</a>
                    &nbsp;<span>|</span>&nbsp;
                  
                    <a target="_self" class="" href="archives.html">Archives</a>
                    &nbsp;<span>|</span>&nbsp;
                                             
                </div>

                <p class="footer-copyright">
                        Copyright &copy; 2019
                        Powered by <a target="_blank" href="http://www.mweb.im">MWeb</a>,&nbsp; 
                        Theme used <a target="_blank" href="https://blog.timac.org">Timac</a>.
                </p>
            </div>
        </footer>



<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
<script type="text/x-mathjax-config">MathJax.Hub.Config({TeX: { equationNumbers: { autoNumber: "AMS" } }});</script>

  













        
      
  
    


    </body>
</html>
