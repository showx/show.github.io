

<!DOCTYPE html>
<html lang="zh">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>
      
    --- - shengsheng的博客
    
    </title>
    
    
    
    <link href="atom.xml" rel="alternate" title="shengsheng的博客" type="application/atom+xml">
    <link rel="stylesheet" href="asset/style.css">
    
</head>
  <body>




        <div id="wrapper">
            <header class="site-header">
                <div class="container">
                    <div class="site-title-wrapper">
                          <a class="button-square" href="index.html">
<svg class="svg-inline--fa fa-home fa-w-18" aria-hidden="true" focusable="false" data-prefix="fas" data-icon="home" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512" data-fa-i2svg=""><path fill="currentColor" d="M280.37 148.26L96 300.11V464a16 16 0 0 0 16 16l112.06-.29a16 16 0 0 0 15.92-16V368a16 16 0 0 1 16-16h64a16 16 0 0 1 16 16v95.64a16 16 0 0 0 16 16.05L464 480a16 16 0 0 0 16-16V300L295.67 148.26a12.19 12.19 0 0 0-15.3 0zM571.6 251.47L488 182.56V44.05a12 12 0 0 0-12-12h-56a12 12 0 0 0-12 12v72.61L318.47 43a48 48 0 0 0-61 0L4.34 251.47a12 12 0 0 0-1.6 16.9l25.5 31A12 12 0 0 0 45.15 301l235.22-193.74a12.19 12.19 0 0 1 15.3 0L530.9 301a12 12 0 0 0 16.9-1.6l25.5-31a12 12 0 0 0-1.7-16.93z"></path></svg>
                            </a>
                        
                         
                        
                        
                        
                        <a class="button-square" href="https://github.com/showx" target="_blank" title="github">
                               <svg class="svg-inline--fa fa-github fa-w-16" aria-hidden="true" focusable="false" data-prefix="fab" data-icon="github" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512" data-fa-i2svg=""><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg><!-- <i class="fab fa-github fa-lg"></i> -->
                          </a>
                        
                        
                      
                      <a class="button-square" href="atom.xml" target="_blank" title="RSS">
                              <svg class="svg-inline--fa fa-rss fa-w-14" aria-hidden="true" focusable="false" data-prefix="fas" data-icon="rss" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" data-fa-i2svg=""><path fill="currentColor" d="M128.081 415.959c0 35.369-28.672 64.041-64.041 64.041S0 451.328 0 415.959s28.672-64.041 64.041-64.041 64.04 28.673 64.04 64.041zm175.66 47.25c-8.354-154.6-132.185-278.587-286.95-286.95C7.656 175.765 0 183.105 0 192.253v48.069c0 8.415 6.49 15.472 14.887 16.018 111.832 7.284 201.473 96.702 208.772 208.772.547 8.397 7.604 14.887 16.018 14.887h48.069c9.149.001 16.489-7.655 15.995-16.79zm144.249.288C439.596 229.677 251.465 40.445 16.503 32.01 7.473 31.686 0 38.981 0 48.016v48.068c0 8.625 6.835 15.645 15.453 15.999 191.179 7.839 344.627 161.316 352.465 352.465.353 8.618 7.373 15.453 15.999 15.453h48.068c9.034-.001 16.329-7.474 16.005-16.504z"></path></svg><!-- <i class="fas fa-rss fa-lg"></i> -->
                      </a>

              
                       
                         
                        
                    </div>

                    <ul class="site-nav">
                        
                    </ul>
                </div>
            </header>

            <div id="container">

 
<div class="container">
  <article class="post-container">
    <header class="post-header">
        <h1 class="post-title">---</h1>
        <p class="post-date">
                <span>Posted <time datetime="2020/02/06" itemprop="datePublished">2020/02/06</time></span>
            </p>
    </header>

    <div class="post-content clearfix">
<p>layout: post<br/>
title: linux 定时任务 crontab 详细解释<br/>
date: 2015-08-19 08:53<br/>
author: admin<br/>
comments: true</p>

<h2 id="toc_0">categories: []</h2>

<p>cron 是linux的内置服务，但它不自动起来，可以用以下的方法启动、关闭这个服务：<br/>
引用:<br/>
/sbin/service crond start //启动服务<br/>
/sbin/service crond stop //关闭服务<br/>
/sbin/service crond restart //重启服务<br/>
/sbin/service crond reload //重新载入配置</p>

<p>//=========================================================================</p>

<h1 id="toc_1">Use the hash sign to prefix a comment</h1>

<h1 id="toc_2">+---------------- minute (0 - 59)</h1>

<h1 id="toc_3">|   +------------- hour (0 - 23)</h1>

<h1 id="toc_4">|   |   +---------- day of month (1 - 31)</h1>

<h1 id="toc_5">|   |   |   +------- month (1 - 12)</h1>

<h1 id="toc_6">|   |   |   |  +---- day of week (0 - 7) (Sunday=0 or 7)</h1>

<h1 id="toc_7">|   |   |   |  |</h1>

<h1 id="toc_8">*  *  *  *  *  command to be executed</h1>

<p>//=============================================================================</p>

<p>很多时候，你没有办法重新启动crond，这个时候可以先killall crond 然后再crond restart就哦ok了。</p>

<p>你也可以将这个服务在系统启动的时候也自动启动：<br/>
引用:<br/>
在/etc/rc.d/rc.local这个脚本的末尾加上：<br/>
/sbin/service crond start</p>

<p>现在cron这个服务已经在进程里面了，我们就可以用这个服务了，cron服务提供以下几种接口供大家使用：<br/>
1.直接用crontab命令编辑<br/>
cron服务提供crontab命令来设定cron服务的，以下是这个命令的一些参数与说明：<br/>
引用:<br/>
crontab -u //设定某个用户的cron服务，一般root用户在执行这个命令的时候需要此参数<br/>
crontab -l //列出某个用户cron服务的详细内容<br/>
crontab -r //删除没个用户的cron服务<br/>
crontab -e //编辑某个用户的cron服务</p>

<p>比如说root查看自己的cron设置：<br/>
引用:<br/>
crontab -u root -l<br/>
再例如，root想删除fred的cron设置：<br/>
引用:<br/>
crontab -u fred -r<br/>
在编辑cron服务时，编辑的内容有一些格式和约定，输入：<br/>
引用:<br/>
crontab -u root -e<br/>
进入vi编辑模式，编辑的内容一定要符合下面的格式：<br/>
引用:<br/>
*/1 * * * * ls &gt;&gt; /tmp/ls.txt<br/>
这 个格式的前一部分是对时间的设定，后面一部分是要执行的命令，如果要执行的命令太多，可以把这些命令写到一个脚本里面，然后在这里直接调用这个脚本就可 以了，调用的时候记得写出命令的完整路径。时间的设定我们有一定的约定，前面五个<em>号代表五个数字，数字的取值范围和含义如下：<br/>
引用:<br/>
分钟　（0-59）<br/>
小时　（0-23）<br/>
日期　（1-31）<br/>
月份　（1-12）<br/>
星期　（0-6）//0代表星期天<br/>
除了数字还有几个个特殊的符号就是&quot;</em>&quot;、&quot;/&quot;和&quot;-&quot;、&quot;,&quot;，<em>代表所有的取值范围内的数字，&quot;/&quot;代表每的意思,&quot;</em>/5&quot;表示每5个单位，&quot;-&quot;代表从某个数字到某个数字,&quot;,&quot;分开几个离散的数字。以下举几个例子说明问题：<br/>
引用:<br/>
每天早上6点<br/>
0 6 * * * echo &quot;Good morning.&quot; &gt;&gt; /tmp/test.txt //注意单纯echo，从屏幕上看不到任何输出，因为cron把任何输出都email到root的信箱了。<br/>
每两个小时<br/>
0 */2 * * * echo &quot;Welcome to <a href="http://beyl.cn.">http://beyl.cn.</a>&quot; &gt;&gt; /tmp/test.txt<br/>
晚上11点到早上8点之间每两个小时，早上八点<br/>
0 23-7/2，8 * * * echo &quot;Welcome to <a href="http://beyl.cn.%EF%BC%9A%EF%BC%89">http://beyl.cn.：）</a>&quot; &gt;&gt; /tmp/test.txt</p>

<p>每个月的4号和每个礼拜的礼拜一到礼拜三的早上11点<br/>
0 11 4 * 1-3 command line</p>

<p>1月1日早上4点<br/>
0 4 1 1 * command line</p>

<p>每次编辑完某个用户的cron设置后，cron自动在/var/spool/cron下生成一个与此用户同名的文件，此用户的cron信息 都记录在这个文 件中，这个文件是不可以直接编辑的，只可以用crontab -e 来编辑。cron启动后每过一份钟读一次这个文件，检查是否要执行里面的命令。因此此文件修改后不需要重新启动cron服务。</p>

<p>2.编辑/etc/crontab 文件配置cron<br/>
cron 服务每分钟不仅要读一次/var/spool/cron内的所有文件，还需要读一次/etc/crontab,因此我们配置这个文件也能运用cron服务 做一些事情。用crontab配置是针对某个用户的，而编辑/etc/crontab是针对系统的任务。此文件的文件格式是：<br/>
引用:<br/>
SHELL=/bin/bash<br/>
PATH=/sbin:/bin:/usr/sbin:/usr/bin<br/>
MAILTO=root //如果出现错误，或者有数据输出，数据作为邮件发给这个帐号<br/>
HOME=/</p>

<h1 id="toc_9">run-parts</h1>

<p>01 * * * * root run-parts /etc/cron.hourly //每个小时去执行一遍/etc/cron.hourly内的脚本<br/>
02 4 * * * root run-parts /etc/cron.daily //每天去执行一遍/etc/cron.daily内的脚本<br/>
22 4 * * 0 root run-parts /etc/cron.weekly //每星期去执行一遍/etc/cron.weekly内的脚本<br/>
42 4 1 * * root run-parts /etc/cron.monthly //每个月去执行一遍/etc/cron.monthly内的脚本<br/>
使用者 运行的路径<br/>
大家注意&quot;run-parts&quot;这个参数了，如果去掉这个参数的话，后面就可以写要运行的某个脚本名，而不是文件夹名了。<br/>
cron<br/>
定时执行指令 ( cron )：<br/>
crontab [*/Minute] [<em>/Hour] [<em>/Day] [</em>/Month] [</em>(/DayOfWeek)?] Command<br/>
Minute: 分钟，1 ~ 59<br/>
Hour : 小时，0 ~ 23<br/>
Day : 日期，1 ~ 31<br/>
Month : 月份，1 ~ 12 或 jan、feb...<br/>
DayOfWeek? : 0（星期日）~ 6（星期六），或 mon、tue...<br/>
Command : 所要执行的指令，中间以 ; 来分隔多个指令。</p>

<p>-e : 编辑 /var/spool/cron/crontabs/UserName 这一个档案。以 # 开头代表批注。<br/>
-l : 列出 /var/spool/cron/crontabs/UserName 这一个档案的内容。<br/>
-d : 删除使用者的工作排程。<br/>
-r : 删除使用者的工作排程档。</p>

<p>Minute，Houre，Day，Month，DayOfWeek? 为条件式，需要符合所有条件的那个时刻指令才会执行。<br/>
用 * 来代表略过这一个条件。<br/>
如果同一个字段有多个条件，中间要用 , 分开。<br/>
如果是指连续一段时间，中间则以 - 分开。<br/>
如果要每隔固定时间执行，则使用 /#，指每隔 # 时刻执行。</p>

<p>crontab 的指令，预设是以 /bin/sh 为直译器，而以使用者的家目录为工作目录。然而使用者可以用 HOME、SHELL、PATH 的变量改变执行时的直译器、预设执行目录与路径。也可以透过设定 MAILTO 设定执行后的纪录要以电子邮件记送到何处。</p>

<h1 id="toc_10">use /bin/sh to run commands, no matter what /etc/passwd says</h1>

<p>SHELL=/bin/sh</p>

<h1 id="toc_11">mail any output to `paul&#39;, no matter whose crontab this is</h1>

<p>MAILTO=paul</p>

<h1 id="toc_12">run five minutes after midnight, every day</h1>

<p>5 0 * * * \(HOME/bin/daily.job &amp;gt;&amp;gt; \)HOME/tmp/out 2&gt;&amp;1</p>

<h1 id="toc_13">run at 2:15pm on the first of every month -- output mailed to paul</h1>

<p>15 14 1 * * $HOME/bin/monthly</p>

<h1 id="toc_14">run at 10 pm on weekdays, annoy Joe</h1>

<p>0 22 * * 1-5 mail -s &quot;It&#39;s 10pm&quot; joe%Joe,%%Where are your kids?%<br/>
23 0-23/2 * * * echo &quot;run 23 minutes after midn, 2am, 4am ..., everyday&quot;<br/>
5 4 * * sun echo &quot;run at 5 after 4 every sunday&quot;<br/>
root 可以用 -u user name 来编辑其它使用者的 crontab 设定。<br/>
crontab -u UserName -e</p>

<p>在开机时，rc 档会载入 crond 这一个 Daemon，<br/>
它会定时去读取这个档案，并依其内容执行指令。<br/>
而指令的执行结果（标准输出／错误输出，stdout/stderr）会以邮件方式寄给系统管理者，<br/>
即 /etc/aliases 档案中的 root : UserName 。</p>

<p>也可以先将指令储存成档案，然后使用<br/>
crontab FileName<br/>
来将要执行的指令写入 /var/spool/cron/crontabs/UserName 这一个档案中</p>

    </div>
    <footer class="post-footer clearfix">
      
           
      
        
    </footer>
     <div class="comments-wrap">
        <div class="share-comments">
          

          

          
        </div>
      </div><!-- end comments wrap -->
  </article>
 </div><!-- end-->



    <footer class="footer">
            <div class="container">
                <div class="site-footer-wrapper">
                        <a class="button-square" href="index.html">
<svg class="svg-inline--fa fa-home fa-w-18" aria-hidden="true" focusable="false" data-prefix="fas" data-icon="home" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512" data-fa-i2svg=""><path fill="currentColor" d="M280.37 148.26L96 300.11V464a16 16 0 0 0 16 16l112.06-.29a16 16 0 0 0 15.92-16V368a16 16 0 0 1 16-16h64a16 16 0 0 1 16 16v95.64a16 16 0 0 0 16 16.05L464 480a16 16 0 0 0 16-16V300L295.67 148.26a12.19 12.19 0 0 0-15.3 0zM571.6 251.47L488 182.56V44.05a12 12 0 0 0-12-12h-56a12 12 0 0 0-12 12v72.61L318.47 43a48 48 0 0 0-61 0L4.34 251.47a12 12 0 0 0-1.6 16.9l25.5 31A12 12 0 0 0 45.15 301l235.22-193.74a12.19 12.19 0 0 1 15.3 0L530.9 301a12 12 0 0 0 16.9-1.6l25.5-31a12 12 0 0 0-1.7-16.93z"></path></svg>
                            </a>
                        
                         
                        
                        
                        
                        <a class="button-square" href="https://github.com/showx" target="_blank" title="github">
                               <svg class="svg-inline--fa fa-github fa-w-16" aria-hidden="true" focusable="false" data-prefix="fab" data-icon="github" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512" data-fa-i2svg=""><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg><!-- <i class="fab fa-github fa-lg"></i> -->
                          </a>
                        
                        
                      
                      <a class="button-square" href="atom.xml" target="_blank" title="RSS">
                              <svg class="svg-inline--fa fa-rss fa-w-14" aria-hidden="true" focusable="false" data-prefix="fas" data-icon="rss" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" data-fa-i2svg=""><path fill="currentColor" d="M128.081 415.959c0 35.369-28.672 64.041-64.041 64.041S0 451.328 0 415.959s28.672-64.041 64.041-64.041 64.04 28.673 64.04 64.041zm175.66 47.25c-8.354-154.6-132.185-278.587-286.95-286.95C7.656 175.765 0 183.105 0 192.253v48.069c0 8.415 6.49 15.472 14.887 16.018 111.832 7.284 201.473 96.702 208.772 208.772.547 8.397 7.604 14.887 16.018 14.887h48.069c9.149.001 16.489-7.655 15.995-16.79zm144.249.288C439.596 229.677 251.465 40.445 16.503 32.01 7.473 31.686 0 38.981 0 48.016v48.068c0 8.625 6.835 15.645 15.453 15.999 191.179 7.839 344.627 161.316 352.465 352.465.353 8.618 7.373 15.453 15.999 15.453h48.068c9.034-.001 16.329-7.474 16.005-16.504z"></path></svg><!-- <i class="fas fa-rss fa-lg"></i> -->
                      </a>

              
                       
                                                
                </div>
                <div class="site-menu-wrapper">
                  &nbsp;<span>|</span>&nbsp;
                  
                    <a target="self" class="" href="index.html">Home</a>
                    &nbsp;<span>|</span>&nbsp;
                  
                    <a target="_self" class="" href="archives.html">Archives</a>
                    &nbsp;<span>|</span>&nbsp;
                                             
                </div>

                <p class="footer-copyright">
                        Copyright &copy; 2019
                        Powered by <a target="_blank" href="http://www.mweb.im">MWeb</a>,&nbsp; 
                        Theme used <a target="_blank" href="https://blog.timac.org">Timac</a>.
                </p>
            </div>
        </footer>



<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
<script type="text/x-mathjax-config">MathJax.Hub.Config({TeX: { equationNumbers: { autoNumber: "AMS" } }});</script>

  













        
      
  
    


    </body>
</html>
